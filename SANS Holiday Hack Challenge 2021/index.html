
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.7">
    
    
      
        <title>Overview - Ashish Gupta</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Ashish Gupta" class="md-header__button md-logo" aria-label="Ashish Gupta" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ashish Gupta
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Ashish Gupta" class="md-nav__button md-logo" aria-label="Ashish Gupta" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Ashish Gupta
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Overview
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#answer-to-objectives-and-high-level-approach" class="md-nav__link">
    Answer to objectives and High-level approach
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="KringleconOrientation/" class="md-nav__link">
        Kringlecon Orientation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Where%20in%20the%20world%20is%20Carmel%20Santaigo/" class="md-nav__link">
        Where in the world is Carmel Santaigo
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Thaw%20Frost%20Tower%20Entrance/" class="md-nav__link">
        Thaw Frost Tower Entrance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Slot%20Machine%20Investigation/" class="md-nav__link">
        Slot Machine Investigation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Thaw%20Frost%20Tower%20Entrance/" class="md-nav__link">
        Thaw Frost Tower Entrance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Strange%20USB%20device/" class="md-nav__link">
        Strange USB Device
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Shell%20Code%20Primer/" class="md-nav__link">
        Shell Code Primer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Printer%20Exploitation/" class="md-nav__link">
        Printer Exploitation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Kerberoasting%20on%20an%20Open%20Fire/" class="md-nav__link">
        Kerberoasting on an Open Fire
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Splunk/" class="md-nav__link">
        Splunk
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Now%20Hiring/" class="md-nav__link">
        Now Hiring
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Customer%20Complaint%20Analysis/" class="md-nav__link">
        Customer Complaint Analysis
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#answer-to-objectives-and-high-level-approach" class="md-nav__link">
    Answer to objectives and High-level approach
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="overview">Overview</h1>
<p><img src="../images/hhc2021/image001.png" alt="drawing" width="1000px"/><br>
This document is a writeup of SANS holiday challenge 2021. This document has answers of all the objectives (total 13), high-level approach as well as details on how those answers were derived.</p>
<table>
<thead>
<tr>
<th>Objective completed</th>
<th>The story</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="../images/hhc2021/image002.png" alt="drawing" width="500px"/></td>
<td>Listen children to a story that was written in the cold<br> 'Bout a ringle and his castle hosting hackers, meek and bold<br> Then from somewhere came another, built his tower tall and proud<br> Surely, he, our Frosty villain hides intentions 'neath a shroud<br> So begins Jack's reckless mission: gather trolls to win a war<br> Build a con that's fresh and shiny, has his yet been done before?<br> Is his Fest more feint than folly? Some have noticed subtle clues<br> Running 'round and raiding repos, stealing Santa's Don'ts and Do's<br> Misdirected, scheming, grasping, Frost intends to seize the day<br> Funding research with a gift shop, can Frost build the better sleigh? <br>Lo, we find unlikely allies: trolls within Jack's own command<br> Doubting Frost and searching motive, questioning his dark demand<br> Is our Jack just lost and rotten - one more outlaw stomping toes?<br> Why then must we piece together cludgy, wacky radios?<br> With this object from the heavens, Frost must know his cover's blown<br> Hearkening from distant planet! We the heroes should have known<br> Go ahead and hack your neighbor, go ahead and phish a friend<br> Do it in the name of holidays, you can justify it at year's end<br> There won't be any retweets praising you, come disclosure day<br> But on the snowy evening after? Still Kris Kringle rides the sleigh</td>
</tr>
</tbody>
</table>
<h2 id="answer-to-objectives-and-high-level-approach">Answer to objectives and High-level approach</h2>
<table>
<thead>
<tr>
<th>Objectives</th>
<th>Answers</th>
<th>High level approach</th>
</tr>
</thead>
<tbody>
<tr>
<td><b>1.Kringlecon Orientation</b></td>
<td><b>answer</b></td>
<td>Write “answer” in the top pane of the terminal presented by the elf Jingle Ringford.</td>
</tr>
<tr>
<td><b>2.Where in the world is Carmel Santaigo?</b></td>
<td><b>Solved in the game</b></td>
<td><b>OWASP Sensitive data exposure :</b><br> (In the flask cookie) Get the hints about the elf and their route info by decoding the flask cookie and use it in the game to follow and find the elf.</td>
</tr>
<tr>
<td><b>3.Thaw Frost Tower's entrance</b></td>
<td><b>Solved in the game</b></td>
<td><b>API Abuse :</b><br> Use the API http://nidus-setup:8080/api/cooler to increase the temperature of the thermostat to thaw the frozen entrance.</td>
</tr>
<tr>
<td><b>4.Slot machine Investigation</b></td>
<td><b>I'm going to have some bouncer trolls bounce you right out of this casino!</td>
<td><b>API Abuse:</b><br>Manipulate the “numline” parameter sent to https://slots.jackfrosttower.com/ to increase the bet amount an exceed 1000 coins and reveal the answer.</td>
</tr>
<tr>
<td><b>5.Strange USB Device</b></td>
<td><b>ickymcgoop</b></td>
<td><b>USB Rubber Ducky :</b> <br> Use mallard.py to decode the encoded USB ducky script (/mnt/USBDEVICE/inject.bin). In the decoded value, find another reversed base64 value, reverse it and decode to find the user for whom an authorized_key file is getting created with the public cert.</td>
</tr>
<tr>
<td><b>6.Shellcode Primer</b></td>
<td><b>cyber security knowledge</b></td>
<td><b>Shell code :</b> <br> On Step 11) '/var/northpolesecrets.txt' <br> 1. Call sys_open to open the file <br> 2. Call sys_read to read the file using buffer (mov rsi, rsp) <br> 3. Call sys_write to write contents from rsp to stdout (Keep the count high e.g., 1000 so we can account for all contents in the file)</td>
</tr>
<tr>
<td><b>7.Printer Exploitation</b></td>
<td><b>Troll_Pay_Chart.xlsx</b></td>
<td><b>Hash Length extender attack :</b> <br> 1.Download the firmware, decode the firmware field from base64 to extract the zip file.<br> 2.Craft the payload to copy the name of last printed xlsx file to a new file and copy the file to /incoming folder.<br> 3.Use hash extender to append our payload zip to original zip file using hash and base64 encode the output. Create the JSON firmware from it.<br> 4. Upload the new JSON firmware to the portal.<br> 5. Download the file from /incoming folder which will have the name of the last printed .xlsx file.<br></td>
</tr>
<tr>
<td><b>8.Kerberoasting on an Open Fire</b></td>
<td><b>Kindness</b></td>
<td><b>Kerberoasting and WriteDACL abuse :</b> <br>1.Get the two shared folders in the network using our user: elfu_svc_shr and research_dep<br>2.Kerberoasting attack to get TGS (Ticket granting service) hash for elfu_svc.<br>3.Use Hashcat to crack TGS hash for elfu_svc user.<br>4.Get hard coded creds for remote_elf embedded in PowerShell script which is stored in \elfu_svc_shr share.<br>5.PrivEsc – Use WriteDACL to add our low priv. user to AD group “Research Department”.<br>6.Access the secret document “SantaSecretToAWonderfulHolidaySeason.pdf” in the \reserach_dep to find the answer.<br></td>
</tr>
<tr>
<td><b>9.Splunk</b></td>
<td><b>whiz</b></td>
<td>Splunk queries on Sysmon and Github audit data <br>(Described in the relevant section below)</td>
</tr>
<tr>
<td><b>10.Now Hiring</b></td>
<td><b>CGgQcSdERePvGgr058r3PObPq3+0CfraKcsLREpX</b></td>
<td><b>Server-Side Request Forgery (SSRF) on EC2 hosted website:</b> <br>1.Website has URL as an input in the “URL to your NLBI report” field.<br> 2.Send http://169.254.169.254/latest/meta-data/iam/security-credentials/ in the URL and see the name of IAM role (“jf-deploy-role”) attached to the EC2 instance returned in the response of the GET request of an image.<br> 3.Send http://169.254.169.254/latest/meta-data/iam/security-credentials/jf-deploy-role in the URL input and get the secret access key returned in the response of the GET request of an image.<br></td>
</tr>
<tr>
<td><b>11.Customer Complaint Analysis</b></td>
<td><b>Flud Hagg Yaqh</b></td>
<td><b>Packet Analysis using Wireshark for RFC 3514 compliance: </b><br>1.    From .pcap file, find the room number for the guest who is RFC 3514 non-compliant using ip.flags.rb == 0</br>2.From the .pcap file, find the trolls who are compliant (ip.flags.rb == 1) and complaining about the guest in the room number found in 1)</td>
</tr>
<tr>
<td><b>12. Frost Tower Website Checkup</b></td>
<td><b>Clerk</b></td>
<td><b>OWASP broken auth and SQL Injection attacks:</b> <br>1.Examine the source code<br>2.Broken auth: Exploit the /postcontact endpoint to log in and get access to the dashboard.<br>3.SQL Injection: Exploit the /detail endpoint to get additional table name (“todo”) and its column names.<br>4.Get data from table “todo” table having the job position for Santa.<br></td>
</tr>
<tr>
<td><b>13. FPGA Programming</b></td>
<td><b>TBD</b></td>
<td>TBD</td>
</tr>
</tbody>
</table>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
      
        
        <a href="KringleconOrientation/" class="md-footer__link md-footer__link--next" aria-label="Next: Kringlecon Orientation" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Kringlecon Orientation
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.01de222e.min.js"></script>
      
    
  </body>
</html>