<table>
        <tr>
        <td><img src="../../images/hhc2021/image011.png" alt="drawing" width="200px"/></td>
        <td>
            <b>Hints from Tangle Coalbox</b><br>
            Turns out some elves have gone on some misdirected journeys around the globe. <br>
            It seems that someone is messing with their travel plans.<br>
            We could sure use your open-source intelligence (OSINT) skills to find them.<br>
            Why dontcha' log into this vintage Cranberry Pi terminal and see if you have what it takes to track them around the globe.<br>
            If you're having any trouble with it, <b>you might ask Piney Sappington right over there for tips</b>.<br>
        </td>
        </tr>
</table>
Tangle Coalbox indicates another elf named “Piney Sappington” may have some hints on how to solve this objective. <br>
So, we head over to that elf now who is also present in the courtyard.

<table>
        <tr>
        <td><img src="../../images/hhc2021/image013.png" alt="drawing" width="200px"/></td>
        <td>
            <b>Hints from Piney Sappington</b><br>
            You see, I've been looking at these documents, and I know someone has tampered with one file. <br>
            Do you think you could log into this Cranberry Pi and take a look?<br>
            It has exiftool installed on it, if that helps you at all.<br>
            I just... Well, I have a feeling that someone at that other conference might have fiddled with things.<br>
            And, if you help me figure this tampering issue out, I’ll give you some hints about OSINT, especially associated with geographic locations!<br>
        </td>
        </tr>
</table>

In the terminal we are presented with the below problem:<br>
>HELP! That wily jack Frost Modified one of our naughty/nice records, and right before Christmas! 
>Can you help us which one? We’ve installed exiftool for your convenience!

<img src="../../images/hhc2021/image014.png" alt="drawing" width="500px"/>

We will get the Last Modified By attribute value for all the docx files and then grep the output it with “Jack”. <br>
That should give us all the files which were last modified by Jack Frost. <br> 
We have -C 5 in the grep so we can get the lines around the matches for the context.

Command entry and output : <br>
<img src="../../images/hhc2021/image015.png" alt="drawing" width="600px"/><br>
Answer verification : <br>
<img src="../../images/hhc2021/image016.png" alt="drawing" width="600px"/><br>
Achivement Unlocked :<br>
<img src="../../images/hhc2021/image017.png" alt="drawing" width="500px"/><br>
Hint Unlocked :<br>
<img src="../../images/hhc2021/image018.png" alt="drawing" width="500px"/>


The “flask cookies” hint is actually a Github Gist from Mr. Chris Elgee. <br>
[https://gist.github.com/chriselgee/b9f1861dd9b99a8c1ed30066b25ff80b](https://gist.github.com/chriselgee/b9f1861dd9b99a8c1ed30066b25ff80b) <br>
That above gist shows how one can decode the value in a cookie generated by Flask applications. <br>

Going back to objective #2 we start the game.<br>
<img src="../../images/hhc2021/caramel_santaigo_start_game.png" alt="drawing" width="500px"/><br>
In the browser we open developer tools. <br>
Under developer tools > Application tab there is a cookie named "Cookiepella" for the domain used for the challenge (caramel.kringlecastle.com).<br>

<img src="../../images/hhc2021/image019.png" alt="drawing" width="1000px"/> <br>

We follow the instructions to decode the value in the flask cookie to JSON.<br>

```python
cookie = "<value of the cookiepella cookie>"
import zlib; import itsdangerous
zlib.decompress(itsdangerous.base64_decode(cookie))
```
<img src="../../images/hhc2021/image020.png" alt="drawing" width="1000px"/> <br>

We format the output JSON for better understanding.<br>
The JSON has details about the elf to identify them. <br>
The JSON has also has the route the elf took. We can take the same route to catch the elf. <br>
<img src="../../images/hhc2021/image021.png" alt="drawing" width="800px"/> <br>

On the visit interlink page, we supply data we have in the decoded flask cookie and click on "Filter Elves". <br>
<img src="../../images/hhc2021/image022.png" alt="drawing" width="1000px"/> <br>

The elves have been filtered out based on the data and possibly Its Morcel Nougat and their location was "Santa's Castel"<br>
Both of these datapoints are also in the decoded cookie value.<br>

Note the route taken by the elf in the decoded cookie value:<br>
<b>Stuttgart, Germany > Tokyo, Japan > London, England > PlaceHolder</b><br>
We click on "Depart by sleigh" to follow the same route to catch up with the elf in London, England.<br>

<table>
        <tr>
            <td>In London, England, we notice there is no option to "Depart by Sleigh"<br>
                which indicates we are close to the elf. We click on Investigate.
            </td>
            <td>
            We are presented with 3 investigate options.<br>
            </td>
        <tr>
        <td>
        <img src="../../images/hhc2021/image023.png" alt="drawing" width="500px"/>
        </td>
        <td>
            <img src="../../images/hhc2021/image024.png" alt="drawing" width="500px"/><br>
        </td>
        </tr>
</table>


When we click on "Investigate 1", It says we have caught up to the elf.<br>
We are given the option to guess the elf.<br>
We choose "Morcel Nouget" since Its also in the name of the elf in the decoded cookie.
<img src="../../images/hhc2021/image025.png" alt="drawing" width="1000px"/> <br>

Upon selecting the elf and clicking on the “Guess Elf” <br>
The message "You've won" appears which means we have completed the challenge.<br>
<img src="../../images/hhc2021/image026.png" alt="drawing" width="500px"/><br>