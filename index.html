
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.7">
    
    
      
        <title>Ashish Gupta</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sans-holiday-hack-challenge-2021" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Ashish Gupta" class="md-header__button md-logo" aria-label="Ashish Gupta" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ashish Gupta
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SANS Holiday Hack Challenge 2021
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Ashish Gupta" class="md-nav__button md-logo" aria-label="Ashish Gupta" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Ashish Gupta
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          SANS Holiday Hack Challenge 2021
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        SANS Holiday Hack Challenge 2021
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#answer-to-objectives-and-high-level-approach" class="md-nav__link">
    Answer to objectives and High-level approach
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-kringlecon-orientation" class="md-nav__link">
    1. Kringlecon Orientation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-where-in-the-world-is-carmel-santaigo" class="md-nav__link">
    2. Where in the world is Carmel Santaigo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-thaw-frost-tower-entrance" class="md-nav__link">
    3. Thaw Frost Tower Entrance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-slot-machine-investigation" class="md-nav__link">
    4. Slot Machine Investigation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-strange-usb-device" class="md-nav__link">
    5. Strange USB device
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-shell-code-primer" class="md-nav__link">
    6. Shell Code Primer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-printer-exploitation" class="md-nav__link">
    7. Printer Exploitation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-kerberoasting-on-an-open-fire" class="md-nav__link">
    8. Kerberoasting on an Open Fire
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-splunk" class="md-nav__link">
    9. Splunk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-now-hiring" class="md-nav__link">
    10. Now Hiring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-customer-complaint-analysis" class="md-nav__link">
    11. Customer Complaint Analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-frost-tower-website-checkup" class="md-nav__link">
    12. Frost Tower Website Checkup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-fpga-programming" class="md-nav__link">
    13. FPGA Programming
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#answer-to-objectives-and-high-level-approach" class="md-nav__link">
    Answer to objectives and High-level approach
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-kringlecon-orientation" class="md-nav__link">
    1. Kringlecon Orientation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-where-in-the-world-is-carmel-santaigo" class="md-nav__link">
    2. Where in the world is Carmel Santaigo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-thaw-frost-tower-entrance" class="md-nav__link">
    3. Thaw Frost Tower Entrance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-slot-machine-investigation" class="md-nav__link">
    4. Slot Machine Investigation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-strange-usb-device" class="md-nav__link">
    5. Strange USB device
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-shell-code-primer" class="md-nav__link">
    6. Shell Code Primer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-printer-exploitation" class="md-nav__link">
    7. Printer Exploitation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-kerberoasting-on-an-open-fire" class="md-nav__link">
    8. Kerberoasting on an Open Fire
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-splunk" class="md-nav__link">
    9. Splunk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-now-hiring" class="md-nav__link">
    10. Now Hiring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-customer-complaint-analysis" class="md-nav__link">
    11. Customer Complaint Analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-frost-tower-website-checkup" class="md-nav__link">
    12. Frost Tower Website Checkup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-fpga-programming" class="md-nav__link">
    13. FPGA Programming
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="sans-holiday-hack-challenge-2021">SANS Holiday Hack Challenge 2021</h1>
<p><img src="images/hhc2021/image001.png" alt="drawing" width="1000px"/></p>
<h2 id="overview">Overview</h2>
<p>This document is a writeup of SANS holiday challenge 2021. This document has answers of all the objectives (total 13), high-level approach as well as details on how those answers were derived.</p>
<table>
<thead>
<tr>
<th>Objective completed</th>
<th>The story</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="images/hhc2021/image002.png" alt="drawing" width="500px"/></td>
<td>Listen children to a story that was written in the cold<br> 'Bout a ringle and his castle hosting hackers, meek and bold<br> Then from somewhere came another, built his tower tall and proud<br> Surely, he, our Frosty villain hides intentions 'neath a shroud<br> So begins Jack's reckless mission: gather trolls to win a war<br> Build a con that's fresh and shiny, has his yet been done before?<br> Is his Fest more feint than folly? Some have noticed subtle clues<br> Running 'round and raiding repos, stealing Santa's Don'ts and Do's<br> Misdirected, scheming, grasping, Frost intends to seize the day<br> Funding research with a gift shop, can Frost build the better sleigh? <br>Lo, we find unlikely allies: trolls within Jack's own command<br> Doubting Frost and searching motive, questioning his dark demand<br> Is our Jack just lost and rotten - one more outlaw stomping toes?<br> Why then must we piece together cludgy, wacky radios?<br> With this object from the heavens, Frost must know his cover's blown<br> Hearkening from distant planet! We the heroes should have known<br> Go ahead and hack your neighbor, go ahead and phish a friend<br> Do it in the name of holidays, you can justify it at year's end<br> There won't be any retweets praising you, come disclosure day<br> But on the snowy evening after? Still Kris Kringle rides the sleigh</td>
</tr>
</tbody>
</table>
<h2 id="answer-to-objectives-and-high-level-approach">Answer to objectives and High-level approach</h2>
<table>
<thead>
<tr>
<th>Objectives</th>
<th>Answers</th>
<th>High level approach</th>
</tr>
</thead>
<tbody>
<tr>
<td><b>1.Kringlecon Orientation</b></td>
<td><b>answer</b></td>
<td>Write “answer” in the top pane of the terminal presented by the elf Jingle Ringford.</td>
</tr>
<tr>
<td><b>2.Where in the world is Carmel Santaigo?</b></td>
<td><b>Solved in the game</b></td>
<td><b>OWASP Sensitive data exposure :</b><br> (In the flask cookie) Get the hints about the elf and their route info by decoding the flask cookie and use it in the game to follow and find the elf.</td>
</tr>
<tr>
<td><b>3.Thaw Frost Tower's entrance</b></td>
<td><b>Solved in the game</b></td>
<td><b>API Abuse :</b><br> Use the API http://nidus-setup:8080/api/cooler to increase the temperature of the thermostat to thaw the frozen entrance.</td>
</tr>
<tr>
<td><b>4.Slot machine Investigation</b></td>
<td><b>I'm going to have some bouncer trolls bounce you right out of this casino!</td>
<td><b>API Abuse:</b><br>Manipulate the “numline” parameter sent to https://slots.jackfrosttower.com/ to increase the bet amount an exceed 1000 coins and reveal the answer.</td>
</tr>
<tr>
<td><b>5.Strange USB Device</b></td>
<td><b>ickymcgoop</b></td>
<td><b>USB Rubber Ducky :</b> <br> Use mallard.py to decode the encoded USB ducky script (/mnt/USBDEVICE/inject.bin). In the decoded value, find another reversed base64 value, reverse it and decode to find the user for whom an authorized_key file is getting created with the public cert.</td>
</tr>
<tr>
<td><b>6.Shellcode Primer</b></td>
<td><b>cyber security knowledge</b></td>
<td><b>Shell code :</b> <br> On Step 11) '/var/northpolesecrets.txt' <br> 1. Call sys_open to open the file <br> 2. Call sys_read to read the file using buffer (mov rsi, rsp) <br> 3. Call sys_write to write contents from rsp to stdout (Keep the count high e.g., 1000 so we can account for all contents in the file)</td>
</tr>
<tr>
<td><b>7.Printer Exploitation</b></td>
<td><b>Troll_Pay_Chart.xlsx</b></td>
<td><b>Hash Length extender attack :</b> <br> 1.Download the firmware, decode the firmware field from base64 to extract the zip file.<br> 2.Craft the payload to copy the name of last printed xlsx file to a new file and copy the file to /incoming folder.<br> 3.Use hash extender to append our payload zip to original zip file using hash and base64 encode the output. Create the JSON firmware from it.<br> 4. Upload the new JSON firmware to the portal.<br> 5. Download the file from /incoming folder which will have the name of the last printed .xlsx file.<br></td>
</tr>
<tr>
<td><b>8.Kerberoasting on an Open Fire</b></td>
<td><b>Kindness</b></td>
<td><b>Kerberoasting and WriteDACL abuse :</b> <br>1.Get the two shared folders in the network using our user: elfu_svc_shr and research_dep<br>2.Kerberoasting attack to get TGS (Ticket granting service) hash for elfu_svc.<br>3.Use Hashcat to crack TGS hash for elfu_svc user.<br>4.Get hard coded creds for remote_elf embedded in PowerShell script which is stored in \elfu_svc_shr share.<br>5.PrivEsc – Use WriteDACL to add our low priv. user to AD group “Research Department”.<br>6.Access the secret document “SantaSecretToAWonderfulHolidaySeason.pdf” in the \reserach_dep to find the answer.<br></td>
</tr>
<tr>
<td><b>9.Splunk</b></td>
<td><b>whiz</b></td>
<td>Splunk queries on Sysmon and Github audit data <br>(Described in the relevant section below)</td>
</tr>
<tr>
<td><b>10.Now Hiring</b></td>
<td><b>CGgQcSdERePvGgr058r3PObPq3+0CfraKcsLREpX</b></td>
<td><b>Server-Side Request Forgery (SSRF) on EC2 hosted website:</b> <br>1.Website has URL as an input in the “URL to your NLBI report” field.<br> 2.Send http://169.254.169.254/latest/meta-data/iam/security-credentials/ in the URL and see the name of IAM role (“jf-deploy-role”) attached to the EC2 instance returned in the response of the GET request of an image.<br> 3.Send http://169.254.169.254/latest/meta-data/iam/security-credentials/jf-deploy-role in the URL input and get the secret access key returned in the response of the GET request of an image.<br></td>
</tr>
<tr>
<td><b>11.Customer Complaint Analysis</b></td>
<td><b>Flud Hagg Yaqh</b></td>
<td><b>Packet Analysis using Wireshark for RFC 3514 compliance: </b><br>1.    From .pcap file, find the room number for the guest who is RFC 3514 non-compliant using ip.flags.rb == 0</br>2.From the .pcap file, find the trolls who are compliant (ip.flags.rb == 1) and complaining about the guest in the room number found in 1)</td>
</tr>
<tr>
<td><b>12. Frost Tower Website Checkup</b></td>
<td><b>Clerk</b></td>
<td><b>OWASP broken auth and SQL Injection attacks:</b> <br>1.Examine the source code<br>2.Broken auth: Exploit the /postcontact endpoint to log in and get access to the dashboard.<br>3.SQL Injection: Exploit the /detail endpoint to get additional table name (“todo”) and its column names.<br>4.Get data from table “todo” table having the job position for Santa.<br></td>
</tr>
<tr>
<td><b>13. FPGA Programming</b></td>
<td><b>TBD</b></td>
<td>TBD</td>
</tr>
</tbody>
</table>
<style>

</style>

<h2 id="1-kringlecon-orientation">1. Kringlecon Orientation</h2>
<!-- 
<table style="table-layout:fixed;overflow-wrap: break-word;width=100%" border="2">
  <tr>
    <td><img src="images/hhc2021/difficulty_1.png" alt="drawing" width="100px"/></td>
    <td><img src="images/hhc2021/image009.png" alt="drawing" width="30px"/>Entry</td>
    <td><img src="images/hhc2021/image010.png" alt="drawing" width="50px"/>Tangle Coalboxsssssssssssssssssssssssssssssssssssssssssssss</td>
  </tr>

</table>

| Header1 | header2 | header3 | header4  |
| ------- | ------- |---------|----------|
| Bar     | bar     | bar     | bar      |

| <img src="images/hhc2021/difficulty_1.png" alt="drawing" width="100px"/>      | <img src="images/hhc2021/image009.png" alt="drawing" width="30px"/>Entry                          | <img src="images/hhc2021/image010.png" alt="drawing" width="50px"/>Tangle Coalbox|
| ----------- | ------------------------------------ |----------------------------------------------|
-->
<p>Upon login on <a href="https://2021.kringlecon.com">https://2021.kringlecon.com</a>, we see Jingle Ringford guarding the entry asking below  <br></p>
<blockquote>
<p>First things first, here's your badge! It's that wrapped present in the middle of your avatar.<br>
Click on the badge on your avatar 🎁. <br>
That’s where you will see your Objectives, Hints, and gathered Items for the Holiday Hack Challenge.<br>
We’ve also got handy links to the KringleCon talks and more there for you!<br>
Next, click on that USB wifi adapter - just in case you need it later.</p>
</blockquote>
<p><img src="images/hhc2021/image003.png" alt="drawing" width="500px"/></p>
<table>
        <tr>
        <td><img src="images/hhc2021/image004.png" alt="drawing" width="200px"/></td>
        <td><img src="images/hhc2021/image005.png" alt="drawing" width="200px"/></td>
        </tr>
</table>

<p>We pick up the Wi-Fi adapter.<br>
We click on the terminal to access it and then type “answer” in the upper pane of the terminal and the gate is opened.<br></p>
<table>
        <tr>
        <td><img src="images/hhc2021/image006.png" alt="drawing" width="500px"/></td>
        <td><img src="images/hhc2021/image007.png" alt="drawing" width="500px"/></td>
        </tr>
</table>

<h2 id="2-where-in-the-world-is-carmel-santaigo">2. Where in the world is Carmel Santaigo</h2>
<table>
        <tr>
        <td><img src="images/hhc2021/image011.png" alt="drawing" width="200px"/></td>
        <td>
            <b>Hints from Tangle Coalbox</b><br>
            Turns out some elves have gone on some misdirected journeys around the globe. <br>
            It seems that someone is messing with their travel plans.<br>
            We could sure use your open-source intelligence (OSINT) skills to find them.<br>
            Why dontcha' log into this vintage Cranberry Pi terminal and see if you have what it takes to track them around the globe.<br>
            If you're having any trouble with it, <b>you might ask Piney Sappington right over there for tips</b>.<br>
        </td>
        </tr>
</table>
<p>Tangle Coalbox indicates another elf named “Piney Sappington” may have some hints on how to solve this objective. <br>
So, we head over to that elf now who is also present in the courtyard.</p>
<table>
        <tr>
        <td><img src="images/hhc2021/image013.png" alt="drawing" width="200px"/></td>
        <td>
            <b>Hints from Piney Sappington</b><br>
            You see, I've been looking at these documents, and I know someone has tampered with one file. <br>
            Do you think you could log into this Cranberry Pi and take a look?<br>
            It has exiftool installed on it, if that helps you at all.<br>
            I just... Well, I have a feeling that someone at that other conference might have fiddled with things.<br>
            And, if you help me figure this tampering issue out, I’ll give you some hints about OSINT, especially associated with geographic locations!<br>
        </td>
        </tr>
</table>

<p>In the terminal we are presented with the below problem:<br></p>
<blockquote>
<p>HELP! That wily jack Frost Modified one of our naughty/nice records, and right before Christmas! 
Can you help us which one? We’ve installed exiftool for your convenience!</p>
</blockquote>
<p><img src="images/hhc2021/image014.png" alt="drawing" width="500px"/></p>
<p>We will get the Last Modified By attribute value for all the docx files and then grep the output it with “Jack”. <br>
That should give us all the files which were last modified by Jack Frost. <br> 
We have -C 5 in the grep so we can get the lines around the matches for the context.</p>
<p>Command entry and output : <br>
<img src="images/hhc2021/image015.png" alt="drawing" width="600px"/><br>
Answer verification : <br>
<img src="images/hhc2021/image016.png" alt="drawing" width="600px"/><br>
Achivement Unlocked :<br>
<img src="images/hhc2021/image017.png" alt="drawing" width="500px"/><br>
Hint Unlocked :<br>
<img src="images/hhc2021/image018.png" alt="drawing" width="500px"/></p>
<p>The “flask cookies” hint is actually a Github Gist from Mr. Chris Elgee. <br>
<a href="https://gist.github.com/chriselgee/b9f1861dd9b99a8c1ed30066b25ff80b">https://gist.github.com/chriselgee/b9f1861dd9b99a8c1ed30066b25ff80b</a> <br>
That above gist shows how one can decode the value in a cookie generated by Flask applications. <br></p>
<p>Going back to objective #2 we start the game.<br>
<img src="images/hhc2021/caramel_santaigo_start_game.png" alt="drawing" width="500px"/><br>
In the browser we open developer tools. <br>
Under developer tools &gt; Application tab there is a cookie named "Cookiepella" for the domain used for the challenge (caramel.kringlecastle.com).<br></p>
<p><img src="images/hhc2021/image019.png" alt="drawing" width="1000px"/> <br></p>
<p>We follow the instructions to decode the value in the flask cookie to JSON.<br></p>
<pre><code class="language-python">cookie = &quot;&lt;value of the cookiepella cookie&gt;&quot;
import zlib; import itsdangerous
zlib.decompress(itsdangerous.base64_decode(cookie))
</code></pre>
<p><img src="images/hhc2021/image020.png" alt="drawing" width="1000px"/> <br></p>
<p>We format the output JSON for better understanding.<br>
The JSON has details about the elf to identify them. <br>
The JSON has also has the route the elf took. We can take the same route to catch the elf. <br>
<img src="images/hhc2021/image021.png" alt="drawing" width="800px"/> <br></p>
<p>On the visit interlink page, we supply data we have in the decoded flask cookie and click on "Filter Elves". <br>
<img src="images/hhc2021/image022.png" alt="drawing" width="1000px"/> <br></p>
<p>The elves have been filtered out based on the data and possibly Its Morcel Nougat and their location was "Santa's Castel"<br>
Both of these datapoints are also in the decoded cookie value.<br></p>
<p>Note the route taken by the elf in the decoded cookie value:<br>
<b>Stuttgart, Germany &gt; Tokyo, Japan &gt; London, England &gt; PlaceHolder</b><br>
We click on "Depart by sleigh" to follow the same route to catch up with the elf in London, England.<br></p>
<table>
        <tr>
            <td>In London, England, we notice there is no option to "Depart by Sleigh"<br>
                which indicates we are close to the elf. We click on Investigate.
            </td>
            <td>
            We are presented with 3 investigate options.<br>
            </td>
        <tr>
        <td>
        <img src="images/hhc2021/image023.png" alt="drawing" width="500px"/>
        </td>
        <td>
            <img src="images/hhc2021/image024.png" alt="drawing" width="500px"/><br>
        </td>
        </tr>
</table>

<p>When we click on "Investigate 1", It says we have caught up to the elf.<br>
We are given the option to guess the elf.<br>
We choose "Morcel Nouget" since Its also in the name of the elf in the decoded cookie.
<img src="images/hhc2021/image025.png" alt="drawing" width="1000px"/> <br></p>
<p>Upon selecting the elf and clicking on the “Guess Elf” <br>
The message "You've won" appears which means we have completed the challenge.<br>
<img src="images/hhc2021/image026.png" alt="drawing" width="500px"/><br></p>
<h2 id="3-thaw-frost-tower-entrance">3. Thaw Frost Tower Entrance</h2>
<table border=1px>
<tr>
    <td colspan=3>
    <b>Challenge : </b> <br>
    Turn up the heat to defrost the entrance to Frost Tower. <br>Click on the Items tab in your badge to find a link to the Wifi Dongle's CLI interface. Talk to Greasy Gopherguts outside the tower for tips
    </td>
</tr>
<tr>
    <td>
    <b>Difficulty Level : </b> <br>
    <img src="images/hhc2021/difficulty_2.png" alt="drawing" width="100px"/><br>
    </td>
    <td>
     <b>Location : </b> <br>
    Frost Tower Entrance
    </td>
    <td>
    <b>Elf/Troll : </b> <br>
   <img src="images/hhc2021/image027.png" alt="drawing" width="30px"/> Grimy McTrollkins <br>
    </td>
</tr>
</table>
<table>
<tr>
    <td>
    <img src="images/hhc2021/image028.png" alt="drawing" width="100px"/>
    </td>
    <td>
    <b> Hints from Grimy McTrollkins </b> <br>
    Yo, I'm Grimy McTrollkins. <br>
    I'm a troll and I work for the big guy over there: Jack Frost.<br>
    I’d rather not be bothered talking with you, but I’m kind of in a bind and need your help.<br>
    Jack Frost is so obsessed with icy cold that he accidentally froze shut the door to Frost Tower!<br>
    I wonder if you can help me get back in.<br>
    I think we can melt the door open if we can just get access to the thermostat inside the building.<br>
    That thermostat uses Wi-Fi. And I’ll bet you picked up a Wi-Fi adapter for your badge when you got to the North Pole.<br>
    Click on your badge and go to the Items tab. There, you should see your Wi-Fi Dongle and a button to “Open Wi-Fi CLI.” That’ll give you<br> command-line interface access to your badge’s wireless capabilities.<br>
    </td>
<tr>
</table>

<p>Click on the badge and go to the Items tab. There, we see the Wi-Fi Dongle and a button to “Open Wi-Fi CLI.” <br>
That gives us command-line interface access to wireless capabilities.<br></p>
<table>
<tr>
    <td>
    <img src="images/hhc2021/image029.png" alt="drawing" width="400px"/>
    </td>
    <td>
    <img src="images/hhc2021/image030.png" alt="drawing" width="600px"/>
    </td>
<tr>
</table>

<p>Scan for any available the ESSIDs  <br></p>
<pre><code class="language-bash">iwlist wlan0 scanning 
</code></pre>
<p><img src="images/hhc2021/image031.png" alt="drawing" width="600px"/></p>
<p>We find an ESSID named “FROST-Nidus-Setup”. <br>
Now we connect to “FROST-Nidus-Setup” ESSID.</p>
<pre><code class="language-bash">iwconfig wlan0 essid FROST-Nidus-Setup
</code></pre>
<p><img src="images/hhc2021/image032.png" alt="drawing" width="1000px"/></p>
<p>Connection succecssful to the ESSID. <br>
Issue a curl command to http://nidus-setup:8080. <br></p>
<pre><code class="language-bash">curl http://nidus-setup:8080
</code></pre>
<p><img src="images/hhc2021/image033.png" alt="drawing" width="1000px"/></p>
<p>Looks like few APIs are hosted there. <br>
Access the API docs <br>
Note the /api/cooler does not need registration <br></p>
<pre><code class="language-bash">curl http://nidus-setup:8080/apidoc
</code></pre>
<p><img src="images/hhc2021/image034.png" alt="drawing" width="800px"/></p>
<p>Following the documentation, we make use of /cooler endpoint passing a temperature which may melt ice e.g., 110 degrees <br></p>
<pre><code class="language-bash">curl -XPOST -H 'Content-Type: application/json' \
  --data-binary '{&quot;temperature&quot;: 110}' \
  http://nidus-setup:8080/api/cooler
</code></pre>
<p><img src="images/hhc2021/image036.png" alt="drawing" width="800px"/></p>
<p>The jack frost tower entrance is now open and the objective is now completed. <br></p>
<table>
<tr>
    <td>
    <img src="images/hhc2021/image037.png" alt="drawing" width="800px"/>
    </td>


    </td>
<tr>
</table>
<p><img src="images/hhc2021/image038.png" alt="drawing" width="500px"/></p>
<h2 id="4-slot-machine-investigation">4. Slot Machine Investigation</h2>
<table border=1px>
<tr>
    <td colspan=3>
    <b>Challenge : </b> <br>
    Test the security of Jack Frost's slot machines. <br> 
    What does the Jack Frost Tower casino security team threaten to do when your coin total exceeds 1000? 
    Submit the string in the server data.response element. <br>
    Talk to Noel Boetie outside Santa's Castle for help.
    </td>
</tr>
<tr>
    <td>
    <b>Difficulty Level : </b> <br>
    <img src="images/hhc2021/difficulty_2.png" alt="drawing" width="100px"/><br>
    </td>
    <td>
     <b>Location : </b> <br>
    Frost Tower Lobby
    </td>
    <td>
    <b>Elf/Troll : </b> <br>
   <img src="images/hhc2021/image027.png" alt="drawing" width="30px"/> Hubris Selfington <br>
    </td>
</tr>
</table>

<table>
<tr>
    <td>
    <img src="images/hhc2021/image039.png" alt="drawing" width="100px"/>
    </td>
    <td>
    <b> Hints from Hubris Selfington </b> <br>
    The big boss told me he’s worried about vulnerabilities in his slot machines, especially this one.<br>
    Statistically speaking, it seems to be paying out way too much.<br>
    He asked me to see if there are any security flaws in it.<br>
    The boss has HUGE plans and we’ve gotta make sure we are running a tight ship here at Frost Tower.<br>
    <b>Hint:</b><br>
    The objective states “Submit the string in the server data. response element”
    </td>
<tr>
</table>

<p>Clicking on the slot machine behind the troll opens <a href="https://slots.jackfrosttower.com" target=_blank>https://slots.jackfrosttower.com</a> where we can click “Play game” to open the game.</p>
<table>
<tr>
    <td>
    <img src="images/hhc2021/image040.png" alt="drawing" width="400px"/>
    </td>
    <td>
    <img src="images/hhc2021/image041.png" alt="drawing" width="600px"/>
    </td>
<tr>
</table>

<p>We open Burp Suite and capture traffic for only slots.jackfrosttower.com. <br>
Click "Spin" in the bottom right corner. <br>
<img src="images/hhc2021/image042.png" alt="drawing" width="400px"/></p>
<p>Burp intercepts the requests and shows a POST request to the /api/v1/<guid>/spin with three parameters: <br> </p>
<ol>
    <li>betamount</li>
    <li>numline</li>
    <li>cpl</li>
</ol>
<p><img src="images/hhc2021/image043.png" alt="drawing" width="600px"/></p>
<p>We investigate with repeater, sending 1001 to the betamount parameter and It does not work. <br>
<img src="images/hhc2021/image044_1.png" alt="drawing" width="1000px"/></p>
<p>Keeping the betamount parameter as 1001 (because we need to bet with &gt;1000 coins), we manipulate the other two parameters, numline and cpl, send them to the API to see if we are successful.</p>
<table>
<tr>
    <th>Manipulating parameter values</th>
    <th>Request</th>
    <th>Response</th>
</tr>
<tr>
    <td>
    Decrease cpl to 0.0
    </td>
    <td>
    <img src="images/hhc2021/image045.png" alt="drawing" width="400px"/>
    </td>
    <td>
    <img src="images/hhc2021/image046.png" alt="drawing" width="400px"/>
    </td>
<tr>
<tr>
    <td>
    Increase cpl to 0.2
    </td>
    <td>
    <img src="images/hhc2021/image047.png" alt="drawing" width="400px"/>
    </td>
    <td>
    <img src="images/hhc2021/image048.png" alt="drawing" width="400px"/>
    </td>
<tr>
<tr>
    <td>
    Decrease numline to 10
    </td>
    <td>
    <img src="images/hhc2021/image049.png" alt="drawing" width="400px"/>
    </td>
    <td>
    <img src="images/hhc2021/image048.png" alt="drawing" width="400px"/>
    </td>
<tr>
<tr>
    <td>
    Increase numline to 30
    </td>
    <td>
    <img src="images/hhc2021/image050.png" alt="drawing" width="400px"/>
    </td>
    <td>
    <img src="images/hhc2021/image048.png" alt="drawing" width="400px"/>
    </td>
<tr>
<tr>
    <td>
    Make numline a negative number
    </td>
    <td>
    <img src="images/hhc2021/image051.png" alt="drawing" width="400px"/>
    </td>
    <td>
    <img src="images/hhc2021/image052.png" alt="drawing" width="1000px"/>
    </td>
<tr>
</table>

<p>Full request and response showing sending a negative value in the numline parameter would show a message in a new field named "response". <br>
<img src="images/hhc2021/image053.png" alt="drawing" width="2000px"/></p>
<p>The successful response shown below : <br>
<img src="images/hhc2021/image054.png" alt="drawing" width="1000px"/></p>
<p>data.response :<br />
<b>I'm going to have some bouncer trolls bounce you right out of this casino!</b> <br></p>
<p>We submit the highlighted as the answer for the Slot Machine Investigation objective and its accepted!<br>
<img src="images/hhc2021/image055.png" alt="drawing" width="400px"/></p>
<h2 id="5-strange-usb-device">5. Strange USB device</h2>
<table border=1px>
<tr>
    <td colspan=3>
    <b>Challenge : </b> <br>
    Assist the elves in reverse engineering the strange USB device. Visit Santa's Talks Floor and hit up Jewel Loggins for advice.
    </td>
</tr>
<tr>
    <td>
    <b>Difficulty Level : </b> <br>
    <img src="images/hhc2021/difficulty_2.png" alt="drawing" width="100px"/><br>
    </td>
    <td>
     <b>Location : </b> <br>
    Santa’s talk floor 
    </td>
    <td>
    <b>Elf/Troll : </b> <br>
   <img src="images/hhc2021/image010.png" alt="drawing" width="30px"/> Morcel Nougat <br>
    </td>
</tr>
</table>

<table>
<tr>
    <td>
    <img src="images/hhc2021/image056.png" alt="drawing" width="300px"/>
    </td>
    <td>
    <b> Hints from Morcel Nougat : </b> <br>
        Do you know anything about USB Rubber Duckies?
        I've been playing around with them a bit myself.<br>
        Please see what you can do to help solve the Rubber Ducky Objective!<br>

        <b>Reference</b><br>
        Talk by Kevin Tyers  <br>
        <a href="https://www.youtube.com/watch?v=tkAYncGF-zw" target="_blank">HIDden Duckey, Deconstructed Payload</a>
    </td>
<tr>
</table>

<p>We open the terminal and presented with a question <br>
Question: What is the troll username involved with this attack. <br>
<img src="images/hhc2021/image057.png" alt="drawing" width="600px"/></p>
<p>We see there is an inject.bin under /mnt/USBDEVICE <br>
<img src="images/hhc2021/image058.png" alt="drawing" width="600px"/></p>
<p>We do the file listing and we see a python file named “mallard.py”. <br>
If we look at the contents of the file, we see the python script takes an "inject.bin" file as an input
<img src="images/hhc2021/image059.png" alt="drawing" width="600px"/>
<img src="images/hhc2021/image060.png" alt="drawing" width="800px"/></p>
<p>We run the mallard.py with the inject.bin as input.</p>
<pre><code class="language-python">python ./mallard.py --file /mnt/USBDEVICE/inject.bin
</code></pre>
<p>The rubber ducky binary inject.bin is decoded.
We see a few interesting things being done in the original file. Numbered in the screenshot below :</p>
<ol>
<li>There is a hardcoded base 64 string which looks like reversed ("==" in the front)</li>
<li>The "rev" used to reverse the already reversed base64 string making it a proper base64 string.</li>
<li>"base64" command with -d switch to decode the base64 string </li>
</ol>

<p><img src="images/hhc2021/image061.png" alt="drawing" width="1000px"/></p>
<p>So we take the above line from the source code  and execute in the terminal <br>
The base64 is reversed and decoded to reveal the user’s name.</p>
<p><img src="images/hhc2021/image062.png" alt="drawing" width="1000px"/></p>
<p>In the above an authorized_key file is getting created with the public cert for the user <b>ickymcgoop</b>.
 The answer is <b>ickymcgoop</b> <br></p>
<p>We submit that username as the answer. 
<img src="images/hhc2021/image063.png" alt="drawing" width="1000px"/></p>
<p>The answer gets accepted and we complete this objective.
<img src="images/hhc2021/image064.png" alt="drawing" width="1000px"/>
<img src="images/hhc2021/image065.png" alt="drawing" width="400px"/></p>
<h2 id="6-shell-code-primer">6. Shell Code Primer</h2>
<table border=1px>
<tr>
    <td colspan=3>
    <b>Challenge : </b> <br>
    Complete the Shellcode Primer in Jack's office.<br>
    According to the last challenge, what is the secret to KringleCon success? "All of our speakers and organizers, providing the gift of ____, free to the community." <br> 
    Talk to Chimney Scissorsticks in the NetWars area for hints.
    </td>
</tr>
<tr>
    <td>
    <b>Difficulty Level : </b> <br>
    <img src="images/hhc2021/difficulty_3.png" alt="drawing" width="100px"/><br>
    </td>
    <td>
     <b>Location : </b> <br>
        Jack’s Office                                                                                     
    </td>
    <td>
    <b>Elf/Troll : </b> <br>
   <img src="images/hhc2021/image027.png" alt="drawing" width="30px"/> Ruby Cyster <br>
    </td>
</tr>
</table>

<table>
<tr>
    <td>
    <img src="images/hhc2021/image056.png" alt="drawing" width="300px"/>
    </td>
    <td>
    <b> Hints from Ruby Cyster : </b> <br>
    I'm looking at this system, and it has me a little bit worried.<br>
    If I didn't know better, I'd say someone here is learning how to hack North Pole systems.<br>
    Who's got that kind of nerve!<br>
    Anyway, I hear some elf on the other roof knows a bit about this type of thing.<br>

    <b> Note:</b> <br>
    The website is <a href="https://tracer.kringlecastle.com/" target="_blank">https://tracer.kringlecastle.com/</a> <br>
    This objective has 11 steps. 1-10 are easy to follow tutorials which will be used for step 11. 
    Step 11 has no hints and solving that would answer this objective. <br>
    Therefore, in the interest of documentation for other objectives in the report we are doing to provide details on step 11 only.
    </td>
<tr>
</table>

<p><b>Shell Code for step 11. Reading a file (/var/northpolesecrets.txt)</b></p>
<pre><code class="language-shell">;sys_open
call doit
db '/var/northpolesecrets.txt',0

doit:
mov rax, 2
pop rdi
mov rsi, 0
mov rdx, 0
syscall

; TODO: Call sys_read on the file handle and read it into rsp
;sys_read
;push rdi ; Temporarily store the filename pointer
;push rax ; Temporarily store the handle
;pop rdi ; Move the file handle into rdi
;pop rsi ; 
mov rdi, rax ; sys_open returns the fd into rax, so move it to rdi before set rax to sys_read.
mov rax, 0 ; Syscall 0 = sys_read
mov rdx, 1000 ; rdx is the count
mov rsi,rsp; from the hint
syscall

; TODO: Call sys_write to write the contents from rsp to stdout (1)
mov rax, 1 ; Syscall 1 = sys_write
mov rdi, 1 ; File handle to write to = stdout = 1  ; (rsi is already the buffer)
mov rdx, 1000; rdx is the count again 
mov rsi, rsp; from the hint
syscall ; Perform the sys_write syscall, writing the data to stdout

; sys_exit
mov rax, 3Ch ; for sys_exit
mov rdi, 0 ; exit code
syscall
</code></pre>
<p><b>The deugger</b> </br>
<img src="images/hhc2021/image067.png" alt="drawing" width="1000px"/></p>
<p>The full content of the file (/var/northpolesecrets.txt) is below. <br>
<b>Secret to KringleCon success: all of our speakers and organizers, providing the gift of cyber security knowledge, free to the community</b> <br></p>
<p>The missing part in the question is <b>"cyber security knowledge"</b>. <br>
We submit it as the answer to this objective and Its now Its completed.</p>
<p><img src="images/hhc2021/image068.png" alt="drawing" width="400px"/></p>
<h2 id="7-printer-exploitation">7. Printer Exploitation</h2>
<h2 id="8-kerberoasting-on-an-open-fire">8. Kerberoasting on an Open Fire</h2>
<h2 id="9-splunk">9. Splunk</h2>
<h2 id="10-now-hiring">10. Now Hiring</h2>
<h2 id="11-customer-complaint-analysis">11. Customer Complaint Analysis</h2>
<h2 id="12-frost-tower-website-checkup">12. Frost Tower Website Checkup</h2>
<h2 id="13-fpga-programming">13. FPGA Programming</h2>
<ul>
<li><code>mkdocs new [dir-name]</code> - Create a new project.</li>
<li><code>mkdocs serve</code> - Start the live-reloading docs server.</li>
<li><code>mkdocs build</code> - Build the documentation site.</li>
<li>
<p><code>mkdocs -h</code> - Print help message and exit.</p>
<p>mkdocs.yml    # The configuration file.
docs/
    index.md  # The documentation homepage.
    ...       # Other markdown pages, images and other files.</p>
</li>
</ul>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.01de222e.min.js"></script>
      
    
  </body>
</html>